import{a as ht,b as ut,c as ct}from"./chunk-K7DDGHQ7.js";import{$ as at,E as ot,P as rt,c as Qe,i as et,j as De,la as lt,q as tt,qa as dt,r as nt,t as it,u as st,z as ue}from"./chunk-HNU362IC.js";var ce=class extends Error{constructor(e,t){super(t),this.type=e}},j=class extends ce{constructor(e,t){super("Configuration",e),this.node=t}},Re=class extends ce{constructor(e){super("PopoutBlocked",e)}},ke=class extends ce{constructor(e){super("API",e)}},Z=class extends ce{constructor(e){super("Bind",e)}};var me=class extends Error{constructor(e,t,n){super(`${e}: ${t}${n===void 0?"":": "+n}`)}},v=class extends me{constructor(e,t){super("Assert",e,t)}},D=class extends me{constructor(e,t,n){super("UnreachableCase",e,`${t}${n===void 0?"":": "+n}`)}},w=class extends me{constructor(e,t){super("UnexpectedNull",e,t)}},g=class extends me{constructor(e,t){super("UnexpectedUndefined",e,t)}};var Ee;(function(o){let e=!1,t={PopoutCannotBeCreatedWithGroundItemConfig:{id:0,default:"Popout cannot be created with ground ItemConfig"},PleaseRegisterAConstructorFunction:{id:1,default:"Please register a constructor function"},ComponentTypeNotRegisteredAndBindComponentEventHandlerNotAssigned:{id:2,default:"Component type not registered and BindComponentEvent handler not assigned"},ComponentIsAlreadyRegistered:{id:3,default:"Component is already registered"},ComponentIsNotVirtuable:{id:4,default:"Component is not virtuable. Requires rootHtmlElement field/getter"},VirtualComponentDoesNotHaveRootHtmlElement:{id:5,default:'Virtual component does not have getter "rootHtmlElement"'},ItemConfigIsNotTypeComponent:{id:6,default:"ItemConfig is not of type component"},InvalidNumberPartInSizeString:{id:7,default:"Invalid number part in size string"},UnknownUnitInSizeString:{id:8,default:"Unknown unit in size string"},UnsupportedUnitInSizeString:{id:9,default:"Unsupported unit in size string"}};o.idCount=Object.keys(t).length;let n=Object.values(t);function i(){if(!e)for(let s=0;s<o.idCount;s++){let r=n[s];if(r.id!==s)throw new v("INSI00110",`${s}: ${r.id}`);U[s]=r.default}e=!0}o.checkInitialise=i})(Ee||(Ee={}));var U=new Array(Ee.idCount);var Se=function(o){return o.defaultComponentBaseZIndex="auto",o.defaultComponentDragZIndex="32",o.defaultComponentStackMaximisedZIndex="41",o}(Se||{});var Ue=function(o){return o.width="width",o.height="height",o}(Ue||{}),X=function(o){return o.top="top",o.left="left",o.right="right",o.bottom="bottom",o}(X||{}),xe=function(o){return o.base="base",o.drag="drag",o.stackMaximised="stackMaximised",o}(xe||{}),ft={base:Se.defaultComponentBaseZIndex,drag:Se.defaultComponentDragZIndex,stackMaximised:Se.defaultComponentStackMaximisedZIndex},mt;(function(o){function e(n){return t(n)}o.isJson=e;function t(n){return!Array.isArray(n)&&n!==null&&typeof n=="object"}o.isJsonObject=t})(mt||(mt={}));var p=function(o){return o.ground="ground",o.row="row",o.column="column",o.stack="stack",o.component="component",o}(p||{}),fe=function(o){return o.none="none",o.always="always",o.onload="onload",o}(fe||{}),S=function(o){return o.Pixel="px",o.Percent="%",o.Fractional="fr",o.Em="em",o}(S||{});(function(o){function e(n){switch(n){case o.Pixel:return o.Pixel;case o.Percent:return o.Percent;case o.Fractional:return o.Fractional;case o.Em:return o.Em;default:return}}o.tryParse=e;function t(n){switch(n){case o.Pixel:return o.Pixel;case o.Percent:return o.Percent;case o.Fractional:return o.Fractional;case o.Em:return o.Em;default:throw new D("SUEF44998",n)}}o.format=t})(S||(S={}));function b(o){return o.toString(10)+"px"}function oe(o){let e=o.replace("px","");return parseFloat(e)}function pt(o){o=o.trimStart();let e=o.length;if(e===0)return{numericPart:"",firstNonNumericCharPart:""};{let t=e,n=!1;for(let r=0;r<e;r++){let a=o[r];if(!Lt(a))if(a!=="."){t=r;break}else if(n){t=r;break}else n=!0}let i=o.substring(0,t),s=o.substring(t).trim();return{numericPart:i,firstNonNumericCharPart:s}}}function Lt(o){return o>="0"&&o<="9"}function _t(o){return o.offsetWidth}function R(o,e){let t=b(e);o.style.width=t}function gt(o){return o.offsetHeight}function k(o,e){let t=b(e);o.style.height=t}function V(o){return{width:o.offsetWidth,height:o.offsetHeight}}function N(o,e){e?o.style.display="":o.style.display="none"}function Ct(o){let e="absolute";o.style.position!==e&&(o.style.position=e)}function ee(o,e){if(e!==void 0){for(let t in e)if(e.hasOwnProperty(t)){let n=e[t],i=o[t];o[t]=te(i,n)}}return o}function te(o,e){if(typeof e!="object")return e;if(Array.isArray(e)){let t=e.length,n=new Array(t);for(let i=0;i<t;i++){let s=e[i];n[i]=te({},s)}return n}else{if(e===null)return null;{let t=e;return o===void 0?ee({},t):typeof o!="object"?ee({},t):Array.isArray(o)?ee({},t):ee(o===null?{}:o,t)}}}function vt(o,e){let t=e.indexOf(o);if(t===-1)throw new Error("Can't remove item from array. Item is not in the array");e.splice(t,1)}function He(){return(Math.random()*1e15).toString(36).replace(".","")}function It(o){return o instanceof Error?o.message:typeof o=="string"?o:"Unknown Error"}var de;(function(o){let e=["settings","hasHeaders","constrainDragToContainer","selectionEnabled","dimensions","borderWidth","minItemHeight","minItemWidth","headerHeight","dragProxyWidth","dragProxyHeight","labels","close","maximise","minimise","popout","content","componentType","componentState","id","width","type","height","isClosable","title","popoutWholeStack","openPopouts","parentId","activeItemIndex","reorderEnabled","borderGrabWidth"],t=[!0,!1,"row","column","stack","component","close","maximise","minimise","open in new window"];function n(){if(e.length>36)throw new Error("Too many keys in config minifier map")}o.checkInitialise=n;function i(m,f){let _={};for(let I in m)if(m.hasOwnProperty(I)){let E;f?E=a(I):E=l(I);let P=m[I];_[E]=r(P,f)}return _}o.translateObject=i;function s(m,f){let _=m.length,I=new Array(_);for(let E=0;E<_;E++){let P=m[E];I[E]=r(P,f)}return I}function r(m,f){return typeof m=="object"?m===null?null:Array.isArray(m)?s(m,f):i(m,f):f?d(m):u(m)}function a(m){if(typeof m=="string"&&m.length===1)return"___"+m;let f=c(m);return f===-1?m:f.toString(36)}function l(m){return m.length===1?e[parseInt(m,36)]:m.substr(0,3)==="___"?m[3]:m}function d(m){if(typeof m=="string"&&m.length===1)return"___"+m;let f=h(m);return f===-1?m:f.toString(36)}function u(m){return typeof m=="string"&&m.length===1?t[parseInt(m,36)]:typeof m=="string"&&m.substr(0,3)==="___"?m[3]:m}function c(m){for(let f=0;f<e.length;f++)if(e[f]===m)return f;return-1}function h(m){for(let f=0;f<t.length;f++)if(t[f]===m)return f;return-1}})(de||(de={}));var y;(function(o){o.defaults={type:p.ground,content:[],size:1,sizeUnit:S.Fractional,minSize:void 0,minSizeUnit:S.Pixel,id:"",isClosable:!0};function e(r,a){switch(r.type){case p.ground:case p.row:case p.column:return re.createCopy(r,a);case p.stack:return q.createCopy(r,a);case p.component:return $.createCopy(r);default:throw new D("CICC91354",r.type,"Invalid Config Item type specified")}}o.createCopy=e;function t(r){switch(r){case p.ground:throw new v("CICCDR91562");case p.row:case p.column:return re.createDefault(r);case p.stack:return q.createDefault();case p.component:return $.createDefault();default:throw new D("CICCDD91563",r,"Invalid Config Item type specified")}}o.createDefault=t;function n(r){return r.type===p.component}o.isComponentItem=n;function i(r){return r.type===p.stack}o.isStackItem=i;function s(r){return r.type===p.ground}o.isGroundItem=s})(y||(y={}));var W;(function(o){o.defaultMaximised=!1;let e;(function(t){function n(i,s){if(i!==void 0)return{show:s??i.show,popout:i.popout,close:i.close,maximise:i.maximise,minimise:i.minimise,tabDropdown:i.tabDropdown}}t.createCopy=n})(e=o.Header||(o.Header={}))})(W||(W={}));var q;(function(o){o.defaultActiveItemIndex=0;function e(i,s){return{type:i.type,content:t(s!==void 0?s:i.content),size:i.size,sizeUnit:i.sizeUnit,minSize:i.minSize,minSizeUnit:i.minSizeUnit,id:i.id,maximised:i.maximised,isClosable:i.isClosable,activeItemIndex:i.activeItemIndex,header:W.Header.createCopy(i.header)}}o.createCopy=e;function t(i){let s=i.length,r=new Array(s);for(let a=0;a<s;a++)r[a]=y.createCopy(i[a]);return r}o.copyContent=t;function n(){return{type:p.stack,content:[],size:y.defaults.size,sizeUnit:y.defaults.sizeUnit,minSize:y.defaults.minSize,minSizeUnit:y.defaults.minSizeUnit,id:y.defaults.id,maximised:W.defaultMaximised,isClosable:y.defaults.isClosable,activeItemIndex:o.defaultActiveItemIndex,header:void 0}}o.createDefault=n})(q||(q={}));var $;(function(o){o.defaultReorderEnabled=!0;function e(s){let r=s.componentType;if(typeof r=="string")return r}o.resolveComponentTypeName=e;function t(s){return{type:s.type,content:[],size:s.size,sizeUnit:s.sizeUnit,minSize:s.minSize,minSizeUnit:s.minSizeUnit,id:s.id,maximised:s.maximised,isClosable:s.isClosable,reorderEnabled:s.reorderEnabled,title:s.title,header:W.Header.createCopy(s.header),componentType:s.componentType,componentState:te(void 0,s.componentState)}}o.createCopy=t;function n(s="",r,a=""){return{type:p.component,content:[],size:y.defaults.size,sizeUnit:y.defaults.sizeUnit,minSize:y.defaults.minSize,minSizeUnit:y.defaults.minSizeUnit,id:y.defaults.id,maximised:W.defaultMaximised,isClosable:y.defaults.isClosable,reorderEnabled:o.defaultReorderEnabled,title:a,header:void 0,componentType:s,componentState:r}}o.createDefault=n;function i(s){return te({},s)}o.copyComponentType=i})($||($={}));var re;(function(o){function e(s){switch(s.type){case p.row:case p.column:case p.stack:case p.component:return!0;case p.ground:return!1;default:throw new D("CROCOSPCICIC13687",s.type)}}o.isChildItemConfig=e;function t(s,r){return{type:s.type,content:n(r!==void 0?r:s.content),size:s.size,sizeUnit:s.sizeUnit,minSize:s.minSize,minSizeUnit:s.minSizeUnit,id:s.id,isClosable:s.isClosable}}o.createCopy=t;function n(s){let r=s.length,a=new Array(r);for(let l=0;l<r;l++)a[l]=y.createCopy(s[l]);return a}o.copyContent=n;function i(s){return{type:s,content:[],size:y.defaults.size,sizeUnit:y.defaults.sizeUnit,minSize:y.defaults.minSize,minSizeUnit:y.defaults.minSizeUnit,id:y.defaults.id,isClosable:y.defaults.isClosable}}o.createDefault=i})(re||(re={}));var K;(function(o){function e(n){return y.createCopy(n)}o.createCopy=e;function t(n){switch(n.type){case p.row:case p.column:case p.stack:case p.component:return!0;case p.ground:return!1;default:throw new D("CROCOSPCICIC13687",n.type)}}o.isRootItemConfig=t})(K||(K={}));var We;(function(o){function e(t){let n=t===void 0?[]:[t];return{type:p.ground,content:n,size:100,sizeUnit:S.Percent,minSize:0,minSizeUnit:S.Pixel,id:"",isClosable:!1,title:"",reorderEnabled:!1}}o.create=e})(We||(We={}));var C;(function(o){let e;(function(u){u.defaults={constrainDragToContainer:!0,reorderEnabled:!0,popoutWholeStack:!1,blockedPopoutsThrowError:!0,closePopoutsOnUnload:!0,responsiveMode:fe.none,tabOverlapAllowance:0,reorderOnTabMenuClick:!0,tabControlOffset:10,popInOnClose:!1};function c(h){return{constrainDragToContainer:h.constrainDragToContainer,reorderEnabled:h.reorderEnabled,popoutWholeStack:h.popoutWholeStack,blockedPopoutsThrowError:h.blockedPopoutsThrowError,closePopoutsOnUnload:h.closePopoutsOnUnload,responsiveMode:h.responsiveMode,tabOverlapAllowance:h.tabOverlapAllowance,reorderOnTabMenuClick:h.reorderOnTabMenuClick,tabControlOffset:h.tabControlOffset,popInOnClose:h.popInOnClose}}u.createCopy=c})(e=o.Settings||(o.Settings={}));let t;(function(u){function c(h){return{borderWidth:h.borderWidth,borderGrabWidth:h.borderGrabWidth,defaultMinItemHeight:h.defaultMinItemHeight,defaultMinItemHeightUnit:h.defaultMinItemHeightUnit,defaultMinItemWidth:h.defaultMinItemWidth,defaultMinItemWidthUnit:h.defaultMinItemWidthUnit,headerHeight:h.headerHeight,dragProxyWidth:h.dragProxyWidth,dragProxyHeight:h.dragProxyHeight}}u.createCopy=c,u.defaults={borderWidth:5,borderGrabWidth:5,defaultMinItemHeight:0,defaultMinItemHeightUnit:S.Pixel,defaultMinItemWidth:10,defaultMinItemWidthUnit:S.Pixel,headerHeight:20,dragProxyWidth:300,dragProxyHeight:200}})(t=o.Dimensions||(o.Dimensions={}));let n;(function(u){function c(h){return{show:h.show,popout:h.popout,dock:h.dock,close:h.close,maximise:h.maximise,minimise:h.minimise,tabDropdown:h.tabDropdown}}u.createCopy=c,u.defaults={show:X.top,popout:"open in new window",dock:"dock",maximise:"maximise",minimise:"minimise",close:"close",tabDropdown:"additional tabs"}})(n=o.Header||(o.Header={}));function i(u){return"parentId"in u}o.isPopout=i;function s(){return{root:void 0,openPopouts:[],dimensions:o.Dimensions.defaults,settings:o.Settings.defaults,header:o.Header.defaults,resolved:!0}}o.createDefault=s;function r(u){return i(u)?pe.createCopy(u):{root:u.root===void 0?void 0:K.createCopy(u.root),openPopouts:o.copyOpenPopouts(u.openPopouts),settings:o.Settings.createCopy(u.settings),dimensions:o.Dimensions.createCopy(u.dimensions),header:o.Header.createCopy(u.header),resolved:u.resolved}}o.createCopy=r;function a(u){let c=u.length,h=new Array(c);for(let m=0;m<c;m++)h[m]=pe.createCopy(u[m]);return h}o.copyOpenPopouts=a;function l(u){return de.translateObject(u,!0)}o.minifyConfig=l;function d(u){return de.translateObject(u,!1)}o.unminifyConfig=d})(C||(C={}));var pe;(function(o){let e;(function(n){function i(s){return{width:s.width,height:s.height,left:s.left,top:s.top}}n.createCopy=i,n.defaults={width:null,height:null,left:null,top:null}})(e=o.Window||(o.Window={}));function t(n){return{root:n.root===void 0?void 0:K.createCopy(n.root),openPopouts:C.copyOpenPopouts(n.openPopouts),settings:C.Settings.createCopy(n.settings),dimensions:C.Dimensions.createCopy(n.dimensions),header:C.Header.createCopy(n.header),parentId:n.parentId,indexInParent:n.indexInParent,window:o.Window.createCopy(n.window),resolved:n.resolved}}o.createCopy=t})(pe||(pe={}));var x;(function(o){function e(h,m){switch(h.type){case p.ground:throw new j("ItemConfig cannot specify type ground",JSON.stringify(h));case p.row:case p.column:return Be.resolve(h,m);case p.stack:return Me.resolve(h,m);case p.component:return Q.resolve(h,m);default:throw new D("UCUICR55499",h.type)}}o.resolve=e;function t(h){if(h===void 0)return[];{let m=h.length,f=new Array(m);for(let _=0;_<m;_++)f[_]=o.resolve(h[_],!1);return f}}o.resolveContent=t;function n(h){return h===void 0?y.defaults.id:Array.isArray(h)?h.length===0?y.defaults.id:h[0]:h}o.resolveId=n;function i(h,m,f,_){if(h!==void 0)return Oe(h,[S.Percent,S.Fractional]);if(m!==void 0||f!==void 0){if(m!==void 0)return{size:m,sizeUnit:S.Percent};if(f!==void 0)return{size:f,sizeUnit:S.Percent};throw new g("CRS33390")}else return _?{size:50,sizeUnit:S.Percent}:{size:y.defaults.size,sizeUnit:y.defaults.sizeUnit}}o.resolveSize=i;function s(h,m,f){if(h!==void 0)return Oe(h,[S.Pixel]);{let _=m!==void 0;return _||f!==void 0?_?{size:m,sizeUnit:S.Pixel}:{size:f,sizeUnit:S.Pixel}:{size:y.defaults.minSize,sizeUnit:y.defaults.minSizeUnit}}}o.resolveMinSize=s;function r(h){return h.size!==void 0?1:h.width!==void 0||h.height!==void 0?2:0}o.calculateSizeWidthHeightSpecificationType=r;function a(h){return h.type===p.ground}o.isGround=a;function l(h){return h.type===p.row}o.isRow=l;function d(h){return h.type===p.column}o.isColumn=d;function u(h){return h.type===p.stack}o.isStack=u;function c(h){return h.type===p.component}o.isComponent=c})(x||(x={}));var _e;(function(o){let e="__glMaximised",t;(function(i){function s(r,a){var l;if(!(r===void 0&&a===void 0))return{show:(l=r?.show)!==null&&l!==void 0?l:a===void 0?void 0:a?C.Header.defaults.show:!1,popout:r?.popout,maximise:r?.maximise,close:r?.close,minimise:r?.minimise,tabDropdown:r?.tabDropdown}}i.resolve=s})(t=o.Header||(o.Header={}));function n(i){let s,r=i.id,a=!1;if(r===void 0)s=y.defaults.id;else if(Array.isArray(r)){let d=r.findIndex(u=>u===e);d>0&&(a=!0,r=r.splice(d,1)),r.length>0?s=r[0]:s=y.defaults.id}else s=r;let l;return i.maximised!==void 0?l=i.maximised:l=a,{id:s,maximised:l}}o.resolveIdAndMaximised=n})(_e||(_e={}));var Me;(function(o){function e(s,r){var a,l;let{id:d,maximised:u}=_e.resolveIdAndMaximised(s),{size:c,sizeUnit:h}=x.resolveSize(s.size,s.width,s.height,r),{size:m,sizeUnit:f}=x.resolveMinSize(s.minSize,s.minWidth,s.minHeight);return{type:p.stack,content:n(s.content),size:c,sizeUnit:h,minSize:m,minSizeUnit:f,id:d,maximised:u,isClosable:(a=s.isClosable)!==null&&a!==void 0?a:y.defaults.isClosable,activeItemIndex:(l=s.activeItemIndex)!==null&&l!==void 0?l:q.defaultActiveItemIndex,header:_e.Header.resolve(s.header,s.hasHeaders)}}o.resolve=e;function t(s){return{type:p.stack,content:i(s.content),size:Pe(s.size,s.sizeUnit),minSize:Je(s.minSize,s.minSizeUnit),id:s.id,maximised:s.maximised,isClosable:s.isClosable,activeItemIndex:s.activeItemIndex,header:W.Header.createCopy(s.header)}}o.fromResolved=t;function n(s){if(s===void 0)return[];{let r=s.length,a=new Array(r);for(let l=0;l<r;l++){let d=s[l],u=x.resolve(d,!1);if(y.isComponentItem(u))a[l]=u;else throw new v("UCUSICRC91114",JSON.stringify(u))}return a}}function i(s){let r=s.length,a=new Array(r);for(let l=0;l<r;l++){let d=s[l];a[l]=Q.fromResolved(d)}return a}})(Me||(Me={}));var Q;(function(o){function e(i,s){var r,a,l;let d=i.componentType;if(d===void 0&&(d=i.componentName),d===void 0)throw new Error("ComponentItemConfig.componentType is undefined");{let{id:u,maximised:c}=_e.resolveIdAndMaximised(i),h;i.title===void 0||i.title===""?h=o.componentTypeToTitle(d):h=i.title;let{size:m,sizeUnit:f}=x.resolveSize(i.size,i.width,i.height,s),{size:_,sizeUnit:I}=x.resolveMinSize(i.minSize,i.minWidth,i.minHeight);return{type:i.type,content:[],size:m,sizeUnit:f,minSize:_,minSizeUnit:I,id:u,maximised:c,isClosable:(r=i.isClosable)!==null&&r!==void 0?r:y.defaults.isClosable,reorderEnabled:(a=i.reorderEnabled)!==null&&a!==void 0?a:$.defaultReorderEnabled,title:h,header:_e.Header.resolve(i.header,i.hasHeaders),componentType:d,componentState:(l=i.componentState)!==null&&l!==void 0?l:{}}}}o.resolve=e;function t(i){return{type:p.component,size:Pe(i.size,i.sizeUnit),minSize:Je(i.minSize,i.minSizeUnit),id:i.id,maximised:i.maximised,isClosable:i.isClosable,reorderEnabled:i.reorderEnabled,title:i.title,header:W.Header.createCopy(i.header),componentType:i.componentType,componentState:te(void 0,i.componentState)}}o.fromResolved=t;function n(i){switch(typeof i){case"string":return i;case"number":return i.toString();case"boolean":return i.toString();default:return""}}o.componentTypeToTitle=n})(Q||(Q={}));var Be;(function(o){function e(r){switch(r.type){case p.row:case p.column:case p.stack:case p.component:return!0;case p.ground:return!1;default:throw new D("UROCOSPCICIC13687",r.type)}}o.isChildItemConfig=e;function t(r,a){var l;let{size:d,sizeUnit:u}=x.resolveSize(r.size,r.width,r.height,a),{size:c,sizeUnit:h}=x.resolveMinSize(r.minSize,r.minWidth,r.minHeight);return{type:r.type,content:o.resolveContent(r.content),size:d,sizeUnit:u,minSize:c,minSizeUnit:h,id:x.resolveId(r.id),isClosable:(l=r.isClosable)!==null&&l!==void 0?l:y.defaults.isClosable}}o.resolve=t;function n(r){return{type:r.type,content:s(r.content),size:Pe(r.size,r.sizeUnit),minSize:Je(r.minSize,r.minSizeUnit),id:r.id,isClosable:r.isClosable}}o.fromResolved=n;function i(r){if(r===void 0)return[];{let a=r.length,l=new Array(a),d=!1,u=!1;for(let m=0;m<a;m++){let f=r[m];if(o.isChildItemConfig(f)){if(!u){let _=x.calculateSizeWidthHeightSpecificationType(f);switch(_){case 0:break;case 2:d=!0;break;case 1:u=!0;break;default:throw new D("ROCICRC87556",_)}}l[m]=f}else throw new j("ItemConfig is not Row, Column or Stack",f)}let c;u?c=!1:d?c=!0:c=!1;let h=new Array(a);for(let m=0;m<a;m++){let f=l[m],_=x.resolve(f,c);if(re.isChildItemConfig(_))h[m]=_;else throw new v("UROCOSPIC99512",JSON.stringify(_))}return h}}o.resolveContent=i;function s(r){let a=r.length,l=new Array(a);for(let d=0;d<a;d++){let u=r[d],c=u.type,h;switch(c){case p.row:case p.column:h=o.fromResolved(u);break;case p.stack:h=Me.fromResolved(u);break;case p.component:h=Q.fromResolved(u);break;default:throw new D("ROCICFRC44797",c)}l[d]=h}return l}})(Be||(Be={}));var ge;(function(o){function e(i){switch(i.type){case p.row:case p.column:case p.stack:case p.component:return!0;case p.ground:return!1;default:throw new D("URICIR23687",i.type)}}o.isRootItemConfig=e;function t(i){if(i!==void 0){let s=x.resolve(i,!1);if(K.isRootItemConfig(s))return s;throw new j("ItemConfig is not Row, Column or Stack",JSON.stringify(i))}}o.resolve=t;function n(i){if(i!==void 0){let s=i.type;switch(s){case p.row:case p.column:return Be.fromResolved(i);case p.stack:return Me.fromResolved(i);case p.component:return Q.fromResolved(i);default:throw new D("RICFROU89921",s)}}}o.fromResolvedOrUndefined=n})(ge||(ge={}));var O;(function(o){let e;(function(d){function u(c){var h,m,f,_,I,E,P,M,H,L;return{constrainDragToContainer:(h=c?.constrainDragToContainer)!==null&&h!==void 0?h:C.Settings.defaults.constrainDragToContainer,reorderEnabled:(m=c?.reorderEnabled)!==null&&m!==void 0?m:C.Settings.defaults.reorderEnabled,popoutWholeStack:(f=c?.popoutWholeStack)!==null&&f!==void 0?f:C.Settings.defaults.popoutWholeStack,blockedPopoutsThrowError:(_=c?.blockedPopoutsThrowError)!==null&&_!==void 0?_:C.Settings.defaults.blockedPopoutsThrowError,closePopoutsOnUnload:(I=c?.closePopoutsOnUnload)!==null&&I!==void 0?I:C.Settings.defaults.closePopoutsOnUnload,responsiveMode:(E=c?.responsiveMode)!==null&&E!==void 0?E:C.Settings.defaults.responsiveMode,tabOverlapAllowance:(P=c?.tabOverlapAllowance)!==null&&P!==void 0?P:C.Settings.defaults.tabOverlapAllowance,reorderOnTabMenuClick:(M=c?.reorderOnTabMenuClick)!==null&&M!==void 0?M:C.Settings.defaults.reorderOnTabMenuClick,tabControlOffset:(H=c?.tabControlOffset)!==null&&H!==void 0?H:C.Settings.defaults.tabControlOffset,popInOnClose:(L=c?.popInOnClose)!==null&&L!==void 0?L:C.Settings.defaults.popInOnClose}}d.resolve=u})(e=o.Settings||(o.Settings={}));let t;(function(d){function u(f){var _,I,E,P,M;let{size:H,sizeUnit:L}=d.resolveDefaultMinItemHeight(f),{size:F,sizeUnit:B}=d.resolveDefaultMinItemWidth(f);return{borderWidth:(_=f?.borderWidth)!==null&&_!==void 0?_:C.Dimensions.defaults.borderWidth,borderGrabWidth:(I=f?.borderGrabWidth)!==null&&I!==void 0?I:C.Dimensions.defaults.borderGrabWidth,defaultMinItemHeight:H,defaultMinItemHeightUnit:L,defaultMinItemWidth:F,defaultMinItemWidthUnit:B,headerHeight:(E=f?.headerHeight)!==null&&E!==void 0?E:C.Dimensions.defaults.headerHeight,dragProxyWidth:(P=f?.dragProxyWidth)!==null&&P!==void 0?P:C.Dimensions.defaults.dragProxyWidth,dragProxyHeight:(M=f?.dragProxyHeight)!==null&&M!==void 0?M:C.Dimensions.defaults.dragProxyHeight}}d.resolve=u;function c(f){return{borderWidth:f.borderWidth,borderGrabWidth:f.borderGrabWidth,defaultMinItemHeight:Pe(f.defaultMinItemHeight,f.defaultMinItemHeightUnit),defaultMinItemWidth:Pe(f.defaultMinItemWidth,f.defaultMinItemWidthUnit),headerHeight:f.headerHeight,dragProxyWidth:f.dragProxyWidth,dragProxyHeight:f.dragProxyHeight}}d.fromResolved=c;function h(f){let _=f?.defaultMinItemHeight;return _===void 0?{size:C.Dimensions.defaults.defaultMinItemHeight,sizeUnit:C.Dimensions.defaults.defaultMinItemHeightUnit}:Oe(_,[S.Pixel])}d.resolveDefaultMinItemHeight=h;function m(f){let _=f?.defaultMinItemWidth;return _===void 0?{size:C.Dimensions.defaults.defaultMinItemWidth,sizeUnit:C.Dimensions.defaults.defaultMinItemWidthUnit}:Oe(_,[S.Pixel])}d.resolveDefaultMinItemWidth=m})(t=o.Dimensions||(o.Dimensions={}));let n;(function(d){function u(c,h,m){var f,_,I,E,P,M,H,L,F,B,le,T;let se;return c?.show!==void 0?se=c.show:h!==void 0&&h.hasHeaders!==void 0?se=h.hasHeaders?C.Header.defaults.show:!1:se=C.Header.defaults.show,{show:se,popout:(_=(f=c?.popout)!==null&&f!==void 0?f:m?.popout)!==null&&_!==void 0?_:h?.showPopoutIcon===!1?!1:C.Header.defaults.popout,dock:(E=(I=c?.popin)!==null&&I!==void 0?I:m?.popin)!==null&&E!==void 0?E:C.Header.defaults.dock,maximise:(M=(P=c?.maximise)!==null&&P!==void 0?P:m?.maximise)!==null&&M!==void 0?M:h?.showMaximiseIcon===!1?!1:C.Header.defaults.maximise,close:(L=(H=c?.close)!==null&&H!==void 0?H:m?.close)!==null&&L!==void 0?L:h?.showCloseIcon===!1?!1:C.Header.defaults.close,minimise:(B=(F=c?.minimise)!==null&&F!==void 0?F:m?.minimise)!==null&&B!==void 0?B:C.Header.defaults.minimise,tabDropdown:(T=(le=c?.tabDropdown)!==null&&le!==void 0?le:m?.tabDropdown)!==null&&T!==void 0?T:C.Header.defaults.tabDropdown}}d.resolve=u})(n=o.Header||(o.Header={}));function i(d){return"parentId"in d||"indexInParent"in d||"window"in d}o.isPopout=i;function s(d){if(i(d))return ze.resolve(d);{let u;return d.root!==void 0?u=d.root:d.content!==void 0&&d.content.length>0?u=d.content[0]:u=void 0,{resolved:!0,root:ge.resolve(u),openPopouts:o.resolveOpenPopouts(d.openPopouts),dimensions:o.Dimensions.resolve(d.dimensions),settings:o.Settings.resolve(d.settings),header:o.Header.resolve(d.header,d.settings,d.labels)}}}o.resolve=s;function r(d){return{root:ge.fromResolvedOrUndefined(d.root),openPopouts:ze.fromResolvedArray(d.openPopouts),settings:C.Settings.createCopy(d.settings),dimensions:o.Dimensions.fromResolved(d.dimensions),header:C.Header.createCopy(d.header)}}o.fromResolved=r;function a(d){let u=d;return u.resolved!==void 0&&u.resolved===!0}o.isResolved=a;function l(d){if(d===void 0)return[];{let u=d.length,c=new Array(u);for(let h=0;h<u;h++)c[h]=ze.resolve(d[h]);return c}}o.resolveOpenPopouts=l})(O||(O={}));var ze;(function(o){let e;(function(s){function r(l,d){var u,c,h,m,f,_,I,E;let P,M=pe.Window.defaults;return l!==void 0?P={width:(u=l.width)!==null&&u!==void 0?u:M.width,height:(c=l.height)!==null&&c!==void 0?c:M.height,left:(h=l.left)!==null&&h!==void 0?h:M.left,top:(m=l.top)!==null&&m!==void 0?m:M.top}:P={width:(f=d?.width)!==null&&f!==void 0?f:M.width,height:(_=d?.height)!==null&&_!==void 0?_:M.height,left:(I=d?.left)!==null&&I!==void 0?I:M.left,top:(E=d?.top)!==null&&E!==void 0?E:M.top},P}s.resolve=r;function a(l){return{width:l.width===null?void 0:l.width,height:l.height===null?void 0:l.height,left:l.left===null?void 0:l.left,top:l.top===null?void 0:l.top}}s.fromResolved=a})(e=o.Window||(o.Window={}));function t(s){var r,a;let l;return s.root!==void 0?l=s.root:s.content!==void 0&&s.content.length>0?l=s.content[0]:l=void 0,{root:ge.resolve(l),openPopouts:O.resolveOpenPopouts(s.openPopouts),dimensions:O.Dimensions.resolve(s.dimensions),settings:O.Settings.resolve(s.settings),header:O.Header.resolve(s.header,s.settings,s.labels),parentId:(r=s.parentId)!==null&&r!==void 0?r:null,indexInParent:(a=s.indexInParent)!==null&&a!==void 0?a:null,window:o.Window.resolve(s.window,s.dimensions),resolved:!0}}o.resolve=t;function n(s){return{root:ge.fromResolvedOrUndefined(s.root),openPopouts:i(s.openPopouts),dimensions:O.Dimensions.fromResolved(s.dimensions),settings:C.Settings.createCopy(s.settings),header:C.Header.createCopy(s.header),parentId:s.parentId,indexInParent:s.indexInParent,window:o.Window.fromResolved(s.window)}}o.fromResolved=n;function i(s){let r=s.length,a=new Array(r);for(let l=0;l<r;l++){let d=s[l];a[l]=o.fromResolved(d)}return a}o.fromResolvedArray=i})(ze||(ze={}));function Oe(o,e){let{numericPart:t,firstNonNumericCharPart:n}=pt(o),i=Number.parseInt(t,10);if(isNaN(i))throw new j(`${U[7]}: ${o}`);{let s=S.tryParse(n);if(s===void 0)throw new j(`${U[8]}: ${o}`);if(e.includes(s))return{size:i,sizeUnit:s};throw new j(`${U[9]}: ${o}`)}}function Pe(o,e){return o.toString(10)+S.format(e)}function Je(o,e){if(o!==void 0)return o.toString(10)+S.format(e)}var z=class o{constructor(){this._allEventSubscriptions=[],this._subscriptionsMap=new Map,this.unbind=this.removeEventListener,this.trigger=this.emit}tryBubbleEvent(e,t){}emit(e,...t){let n=this._subscriptionsMap.get(e);if(n!==void 0){n=n.slice();for(let i=0;i<n.length;i++){let s=n[i];s(...t)}}this.emitAllEvent(e,t),this.tryBubbleEvent(e,t)}emitUnknown(e,...t){let n=this._subscriptionsMap.get(e);if(n!==void 0){n=n.slice();for(let i=0;i<n.length;i++)n[i](...t)}this.emitAllEvent(e,t),this.tryBubbleEvent(e,t)}emitBaseBubblingEvent(e){let t=new o.BubblingEvent(e,this);this.emitUnknown(e,t)}emitUnknownBubblingEvent(e){let t=new o.BubblingEvent(e,this);this.emitUnknown(e,t)}removeEventListener(e,t){let n=t;this.removeUnknownEventListener(e,n)}off(e,t){this.removeEventListener(e,t)}addEventListener(e,t){let n=t;this.addUnknownEventListener(e,n)}on(e,t){this.addEventListener(e,t)}addUnknownEventListener(e,t){if(e===o.ALL_EVENT)this._allEventSubscriptions.push(t);else{let n=this._subscriptionsMap.get(e);n!==void 0?n.push(t):(n=[t],this._subscriptionsMap.set(e,n))}}removeUnknownEventListener(e,t){if(e===o.ALL_EVENT)this.removeSubscription(e,this._allEventSubscriptions,t);else{let n=this._subscriptionsMap.get(e);if(n===void 0)throw new Error("No subscribtions to unsubscribe for event "+e);this.removeSubscription(e,n,t)}}removeSubscription(e,t,n){let i=t.indexOf(n);if(i<0)throw new Error("Nothing to unbind for "+e);t.splice(i,1)}emitAllEvent(e,t){let n=this._allEventSubscriptions.length;if(n>0){let i=t.slice();i.unshift(e);let s=this._allEventSubscriptions.slice();for(let r=0;r<n;r++)s[r](...i)}}};(function(o){o.ALL_EVENT="__all",o.headerClickEventName="stackHeaderClick",o.headerTouchStartEventName="stackHeaderTouchStart";class e{constructor(s,r){this._name=s,this._target=r,this._isPropagationStopped=!1}get name(){return this._name}get target(){return this._target}get origin(){return this._target}get isPropagationStopped(){return this._isPropagationStopped}stopPropagation(){this._isPropagationStopped=!0}}o.BubblingEvent=e;class t extends e{constructor(s,r,a){super(s,r),this._mouseEvent=a}get mouseEvent(){return this._mouseEvent}}o.ClickBubblingEvent=t;class n extends e{constructor(s,r,a){super(s,r),this._touchEvent=a}get touchEvent(){return this._touchEvent}}o.TouchStartBubblingEvent=n})(z||(z={}));var Fe=class extends z{constructor(e,t,n,i,s,r,a,l,d){super(),this._config=e,this._parent=t,this._layoutManager=n,this._element=i,this._updateItemConfigEvent=s,this._showEvent=r,this._hideEvent=a,this._focusEvent=l,this._blurEvent=d,this._stackMaximised=!1,this._width=0,this._height=0,this._visible=!0,this._isShownWithZeroDimensions=!0,this._componentType=e.componentType,this._isClosable=e.isClosable,this._initialState=e.componentState,this._state=this._initialState,this._boundComponent=this.layoutManager.bindComponent(this,e),this.updateElementPositionPropertyFromBoundComponent()}get width(){return this._width}get height(){return this._height}get parent(){return this._parent}get componentName(){return this._componentType}get componentType(){return this._componentType}get virtual(){return this._boundComponent.virtual}get component(){return this._boundComponent.component}get tab(){return this._tab}get title(){return this._parent.title}get layoutManager(){return this._layoutManager}get isHidden(){return!this._visible}get visible(){return this._visible}get state(){return this._state}get initialState(){return this._initialState}get element(){return this._element}destroy(){this.releaseComponent(),this.stateRequestEvent=void 0,this.emit("destroy")}getElement(){return this._element}hide(){this._hideEvent()}show(){this._showEvent()}focus(e=!1){this._focusEvent(e)}blur(e=!1){this._blurEvent(e)}setSize(e,t){let n=this._parent;if(n.isColumn||n.isRow||n.parent===null)throw new v("ICSSPRC","ComponentContainer cannot have RowColumn Parent");{let i;do i=n,n=n.parent;while(n!==null&&!n.isColumn&&!n.isRow);if(n===null)return!1;{let s=n.isColumn?"height":"width",r=this[s];if(r===null)throw new w("ICSSCS11194");{let a=s==="height"?t:e,l=r*(1/(i.size/100)),d=a/l*100,u=(i.size-d)/(n.contentItems.length-1);for(let c=0;c<n.contentItems.length;c++){let h=n.contentItems[c];h===i?h.size=d:h.size+=u}return n.updateSize(!1),!0}}}}close(){this._isClosable&&(this.emit("close"),this._parent.close())}replaceComponent(e){if(this.releaseComponent(),x.isComponent(e)){let t=Q.resolve(e,!1);if(this._initialState=t.componentState,this._state=this._initialState,this._componentType=t.componentType,this._updateItemConfigEvent(t),this._boundComponent=this.layoutManager.bindComponent(this,t),this.updateElementPositionPropertyFromBoundComponent(),this._boundComponent.virtual){if(this.virtualVisibilityChangeRequiredEvent!==void 0&&this.virtualVisibilityChangeRequiredEvent(this,this._visible),this.virtualRectingRequiredEvent!==void 0){this._layoutManager.fireBeforeVirtualRectingEvent(1);try{this.virtualRectingRequiredEvent(this,this._width,this._height)}finally{this._layoutManager.fireAfterVirtualRectingEvent()}}this.setBaseLogicalZIndex()}this.emit("stateChanged")}else throw new Error("ReplaceComponent not passed a component ItemConfig")}getState(){return this._state}extendState(e){let t=ee(this._state,e);this.setState(t)}setState(e){this._state=e,this._parent.emitBaseBubblingEvent("stateChanged")}setTitle(e){this._parent.setTitle(e)}setTab(e){this._tab=e,this.emit("tab",e)}setVisibility(e){this._boundComponent.virtual&&this.virtualVisibilityChangeRequiredEvent!==void 0&&this.virtualVisibilityChangeRequiredEvent(this,e),e?this._visible?this._isShownWithZeroDimensions&&(this._height!==0||this._width!==0)&&(this._isShownWithZeroDimensions=!1,this.setSizeToNodeSize(this._width,this._height,!0),this.emitShow()):(this._visible=!0,this._height===0&&this._width===0?this._isShownWithZeroDimensions=!0:(this._isShownWithZeroDimensions=!1,this.setSizeToNodeSize(this._width,this._height,!0),this.emitShow())):this._visible&&(this._visible=!1,this._isShownWithZeroDimensions=!1,this.emitHide())}setBaseLogicalZIndex(){this.setLogicalZIndex(xe.base)}setLogicalZIndex(e){e!==this._logicalZIndex&&(this._logicalZIndex=e,this.notifyVirtualZIndexChangeRequired())}enterDragMode(e,t){this._width=e,this._height=t,R(this._element,e),k(this._element,t),this.setLogicalZIndex(xe.drag),this.drag()}exitDragMode(){this.setBaseLogicalZIndex()}enterStackMaximised(){this._stackMaximised=!0,this.setLogicalZIndex(xe.stackMaximised)}exitStackMaximised(){this.setBaseLogicalZIndex(),this._stackMaximised=!1}drag(){if(this._boundComponent.virtual&&this.virtualRectingRequiredEvent!==void 0){this._layoutManager.fireBeforeVirtualRectingEvent(1);try{this.virtualRectingRequiredEvent(this,this._width,this._height)}finally{this._layoutManager.fireAfterVirtualRectingEvent()}}}setSizeToNodeSize(e,t,n){(e!==this._width||t!==this._height||n)&&(this._width=e,this._height=t,R(this._element,e),k(this._element,t),this._boundComponent.virtual?this.addVirtualSizedContainerToLayoutManager():(this.emit("resize"),this.checkShownFromZeroDimensions()))}notifyVirtualRectingRequired(){this.virtualRectingRequiredEvent!==void 0&&(this.virtualRectingRequiredEvent(this,this._width,this._height),this.emit("resize"),this.checkShownFromZeroDimensions())}notifyVirtualZIndexChangeRequired(){if(this.virtualZIndexChangeRequiredEvent!==void 0){let e=this._logicalZIndex,t=ft[e];this.virtualZIndexChangeRequiredEvent(this,e,t)}}updateElementPositionPropertyFromBoundComponent(){this._boundComponent.virtual?this._element.style.position="static":this._element.style.position=""}addVirtualSizedContainerToLayoutManager(){this._layoutManager.beginVirtualSizedContainerAdding();try{this._layoutManager.addVirtualSizedContainer(this)}finally{this._layoutManager.endVirtualSizedContainerAdding()}}checkShownFromZeroDimensions(){this._isShownWithZeroDimensions&&(this._height!==0||this._width!==0)&&(this._isShownWithZeroDimensions=!1,this.emitShow())}emitShow(){this.emit("shown"),this.emit("show")}emitHide(){this.emit("hide")}releaseComponent(){this._stackMaximised&&this.exitStackMaximised(),this.emit("beforeComponentRelease",this._boundComponent.component),this.layoutManager.unbindComponent(this,this._boundComponent.virtual,this._boundComponent.component)}};var Ve=class extends z{constructor(e,t,n){super(),this._config=e,this._initialWindowSize=t,this._layoutManager=n,this._isInitialised=!1,this._popoutWindow=null,this.createWindow()}toConfig(){var e,t;if(this._isInitialised===!1)throw new Error("Can't create config, layout not yet initialised");let i=this.getGlInstance().saveLayout(),s,r;this._popoutWindow===null?(s=null,r=null):(s=(e=this._popoutWindow.screenX)!==null&&e!==void 0?e:this._popoutWindow.screenLeft,r=(t=this._popoutWindow.screenY)!==null&&t!==void 0?t:this._popoutWindow.screenTop);let a={width:this.getGlInstance().width,height:this.getGlInstance().height,left:s,top:r};return{root:i.root,openPopouts:i.openPopouts,settings:i.settings,dimensions:i.dimensions,header:i.header,window:a,parentId:this._config.parentId,indexInParent:this._config.indexInParent,resolved:!0}}getGlInstance(){if(this._popoutWindow===null)throw new w("BPGGI24693");return this._popoutWindow.__glInstance}getWindow(){if(this._popoutWindow===null)throw new w("BPGW087215");return this._popoutWindow}close(){if(this.getGlInstance())this.getGlInstance().closeWindow();else try{this.getWindow().close()}catch{}}popIn(){let e,t=this._config.indexInParent;if(!this._config.parentId)return;let n=this.getGlInstance().saveLayout(),s=ee({},n).root;if(s===void 0)throw new g("BPPIR19998");let r=this._layoutManager.groundItem;if(r===void 0)throw new g("BPPIG34972");e=r.getItemsByPopInParentId(this._config.parentId)[0],e||(r.contentItems.length>0?e=r.contentItems[0]:e=r,t=0);let a=this._layoutManager.createAndInitContentItem(s,e);e.addChild(a,t),this._layoutManager.layoutConfig.settings.popInOnClose?this._onClose():this.close()}createWindow(){let e=this.createUrl(),t=Math.floor(Math.random()*1e6).toString(36),n=this.serializeWindowFeatures({width:this._initialWindowSize.width,height:this._initialWindowSize.height,innerWidth:this._initialWindowSize.width,innerHeight:this._initialWindowSize.height,menubar:"no",toolbar:"no",location:"no",personalbar:"no",resizable:"yes",scrollbars:"no",status:"no"});if(this._popoutWindow=globalThis.open(e,t,n),!this._popoutWindow){if(this._layoutManager.layoutConfig.settings.blockedPopoutsThrowError===!0)throw new Re("Popout blocked");return}this._popoutWindow.addEventListener("load",()=>this.positionWindow(),{passive:!0}),this._popoutWindow.addEventListener("beforeunload",()=>{this._layoutManager.layoutConfig.settings.popInOnClose?this.popIn():this._onClose()},{passive:!0}),this._checkReadyInterval=setInterval(()=>this.checkReady(),10)}checkReady(){if(this._popoutWindow===null)throw new w("BPCR01844");this._popoutWindow.__glInstance&&this._popoutWindow.__glInstance.isInitialised&&(this.onInitialised(),this._checkReadyInterval!==void 0&&(clearInterval(this._checkReadyInterval),this._checkReadyInterval=void 0))}serializeWindowFeatures(e){let t=[];for(let n in e)t.push(n+"="+e[n].toString());return t.join(",")}createUrl(){let e="gl-window-config-"+He(),t=C.minifyConfig(this._config);try{localStorage.setItem(e,JSON.stringify(t))}catch(i){throw new Error("Error while writing to localStorage "+It(i))}let n=new URL(location.href);return n.searchParams.set("gl-window",e),n.toString()}positionWindow(){if(this._popoutWindow===null)throw new Error("BrowserPopout.positionWindow: null popoutWindow");this._popoutWindow.moveTo(this._initialWindowSize.left,this._initialWindowSize.top),this._popoutWindow.focus()}onInitialised(){this._isInitialised=!0,this.getGlInstance().on("popIn",()=>this.popIn()),this.emit("initialised")}_onClose(){setTimeout(()=>this.emit("closed"),50)}};var A=class extends z{constructor(e,t,n,i){super(),this.layoutManager=e,this._parent=n,this._element=i,this._popInParentIds=[],this._type=t.type,this._id=t.id,this._isInitialised=!1,this.isGround=!1,this.isRow=!1,this.isColumn=!1,this.isStack=!1,this.isComponent=!1,this.size=t.size,this.sizeUnit=t.sizeUnit,this.minSize=t.minSize,this.minSizeUnit=t.minSizeUnit,this._isClosable=t.isClosable,this._pendingEventPropagations={},this._throttledEvents=["stateChanged"],this._contentItems=this.createContentItems(t.content)}get type(){return this._type}get id(){return this._id}set id(e){this._id=e}get popInParentIds(){return this._popInParentIds}get parent(){return this._parent}get contentItems(){return this._contentItems}get isClosable(){return this._isClosable}get element(){return this._element}get isInitialised(){return this._isInitialised}static isStack(e){return e.isStack}static isComponentItem(e){return e.isComponent}static isComponentParentableItem(e){return e.isStack||e.isGround}removeChild(e,t=!1){let n=this._contentItems.indexOf(e);if(n===-1)throw new Error("Can't remove child item. Unknown content item");if(t||this._contentItems[n].destroy(),this._contentItems.splice(n,1),this._contentItems.length>0)this.updateSize(!1);else if(!this.isGround&&this._isClosable===!0){if(this._parent===null)throw new w("CIUC00874");this._parent.removeChild(this)}}addChild(e,t,n){return t??(t=this._contentItems.length),this._contentItems.splice(t,0,e),e.setParent(this),this._isInitialised===!0&&e._isInitialised===!1&&e.init(),t}replaceChild(e,t,n=!1){let i=this._contentItems.indexOf(e),s=e._element.parentNode;if(i===-1)throw new v("CIRCI23232","Can't replace child. oldChild is not child of this");if(s===null)throw new w("CIRCP23232");if(s.replaceChild(t._element,e._element),n===!0&&(e._parent=null,e.destroy()),this._contentItems[i]=t,t.setParent(this),t.size=e.size,t.sizeUnit=e.sizeUnit,t.minSize=e.minSize,t.minSizeUnit=e.minSizeUnit,t._parent===null)throw new w("CIRCNC45699");t._parent._isInitialised===!0&&t._isInitialised===!1&&t.init(),this.updateSize(!1)}remove(){if(this._parent===null)throw new w("CIR11110");this._parent.removeChild(this)}popout(){let e=He(),t=this.layoutManager.createPopoutFromContentItem(this,void 0,e,void 0);return this.emitBaseBubblingEvent("stateChanged"),t}calculateConfigContent(){let e=this._contentItems,t=e.length,n=new Array(t);for(let i=0;i<t;i++){let s=e[i];n[i]=s.toConfig()}return n}highlightDropZone(e,t,n){let i=this.layoutManager.dropTargetIndicator;if(i===null)throw new w("ACIHDZ5593");i.highlightArea(n,1)}onDrop(e,t){this.addChild(e)}show(){this.layoutManager.beginSizeInvalidation();try{N(this._element,!0);for(let e=0;e<this._contentItems.length;e++)this._contentItems[e].show()}finally{this.layoutManager.endSizeInvalidation()}}destroy(){for(let e=0;e<this._contentItems.length;e++)this._contentItems[e].destroy();this._contentItems=[],this.emitBaseBubblingEvent("beforeItemDestroyed"),this._element.remove(),this.emitBaseBubblingEvent("itemDestroyed")}getElementArea(e){e=e??this._element;let t=e.getBoundingClientRect(),n=t.top+document.body.scrollTop,i=t.left+document.body.scrollLeft,s=t.width,r=t.height;return{x1:i,y1:n,x2:i+s,y2:n+r,surface:s*r,contentItem:this}}init(){this._isInitialised=!0,this.emitBaseBubblingEvent("itemCreated"),this.emitUnknownBubblingEvent(this.type+"Created")}setParent(e){this._parent=e}addPopInParentId(e){this.popInParentIds.includes(e)||this.popInParentIds.push(e)}initContentItems(){for(let e=0;e<this._contentItems.length;e++)this._contentItems[e].init()}hide(){this.layoutManager.beginSizeInvalidation();try{N(this._element,!1)}finally{this.layoutManager.endSizeInvalidation()}}updateContentItemsSize(e){for(let t=0;t<this._contentItems.length;t++)this._contentItems[t].updateSize(e)}createContentItems(e){let t=e.length,n=new Array(t);for(let i=0;i<e.length;i++)n[i]=this.layoutManager.createContentItem(e[i],this);return n}propagateEvent(e,t){if(t.length===1){let n=t[0];n instanceof z.BubblingEvent&&n.isPropagationStopped===!1&&this._isInitialised===!0&&(this.isGround===!1&&this._parent?this._parent.emitUnknown(e,n):this.scheduleEventPropagationToLayoutManager(e,n))}}tryBubbleEvent(e,t){if(t.length===1){let n=t[0];n instanceof z.BubblingEvent&&n.isPropagationStopped===!1&&this._isInitialised===!0&&(this.isGround===!1&&this._parent?this._parent.emitUnknown(e,n):this.scheduleEventPropagationToLayoutManager(e,n))}}scheduleEventPropagationToLayoutManager(e,t){this._throttledEvents.indexOf(e)===-1?this.layoutManager.emitUnknown(e,t):this._pendingEventPropagations[e]!==!0&&(this._pendingEventPropagations[e]=!0,globalThis.requestAnimationFrame(()=>this.propagateEventToLayoutManager(e,t)))}propagateEventToLayoutManager(e,t){this._pendingEventPropagations[e]=!1,this.layoutManager.emitUnknown(e,t)}};var G=class extends A{constructor(e,t,n){super(e,t,n,document.createElement("div")),this._parentItem=n,this._focused=!1,this.isComponent=!0,this._reorderEnabled=t.reorderEnabled,this.applyUpdatableConfig(t),this._initialWantMaximise=t.maximised;let i=document.createElement("div");i.classList.add("lm_content"),this.element.appendChild(i),this._container=new Fe(t,this,e,i,s=>this.handleUpdateItemConfigEvent(s),()=>this.show(),()=>this.hide(),s=>this.focus(s),s=>this.blur(s))}get componentName(){return this._container.componentType}get componentType(){return this._container.componentType}get reorderEnabled(){return this._reorderEnabled}get initialWantMaximise(){return this._initialWantMaximise}get component(){return this._container.component}get container(){return this._container}get parentItem(){return this._parentItem}get headerConfig(){return this._headerConfig}get title(){return this._title}get tab(){return this._tab}get focused(){return this._focused}destroy(){this._container.destroy(),super.destroy()}applyUpdatableConfig(e){this.setTitle(e.title),this._headerConfig=e.header}toConfig(){let e=this._container.stateRequestEvent,t=e===void 0?this._container.state:e();return{type:p.component,content:[],size:this.size,sizeUnit:this.sizeUnit,minSize:this.minSize,minSizeUnit:this.minSizeUnit,id:this.id,maximised:!1,isClosable:this.isClosable,reorderEnabled:this._reorderEnabled,title:this._title,header:W.Header.createCopy(this._headerConfig),componentType:$.copyComponentType(this.componentType),componentState:t}}close(){if(this.parent===null)throw new w("CIC68883");this.parent.removeChild(this,!1)}enterDragMode(e,t){R(this.element,e),k(this.element,t),this._container.enterDragMode(e,t)}exitDragMode(){this._container.exitDragMode()}enterStackMaximised(){this._container.enterStackMaximised()}exitStackMaximised(){this._container.exitStackMaximised()}drag(){this._container.drag()}updateSize(e){this.updateNodeSize(e)}init(){this.updateNodeSize(!1),super.init(),this._container.emit("open"),this.initContentItems()}setTitle(e){this._title=e,this.emit("titleChanged",e),this.emit("stateChanged")}setTab(e){this._tab=e,this.emit("tab",e),this._container.setTab(e)}hide(){super.hide(),this._container.setVisibility(!1)}show(){super.show(),this._container.setVisibility(!0)}focus(e=!1){this.parentItem.setActiveComponentItem(this,!0,e)}setFocused(e){this._focused=!0,this.tab.setFocused(),e||this.emitBaseBubblingEvent("focus")}blur(e=!1){this._focused&&this.layoutManager.setFocusedComponentItem(void 0,e)}setBlurred(e){this._focused=!1,this.tab.setBlurred(),e||this.emitBaseBubblingEvent("blur")}setParent(e){this._parentItem=e,super.setParent(e)}handleUpdateItemConfigEvent(e){this.applyUpdatableConfig(e)}updateNodeSize(e){if(this.element.style.display!=="none"){let{width:t,height:n}=V(this.element);this._container.setSizeToNodeSize(t,n,e)}}};var Ce=class extends A{constructor(){super(...arguments),this._focused=!1}get focused(){return this._focused}setFocusedValue(e){this._focused=e}};var ae=class extends z{constructor(e,t){super(),this._eElement=e,this._pointerTracking=!1,this._pointerDownEventListener=n=>this.onPointerDown(n),this._pointerMoveEventListener=n=>this.onPointerMove(n),this._pointerUpEventListener=n=>this.onPointerUp(n),this._timeout=void 0,this._allowableTargets=[e,...t],this._oDocument=document,this._eBody=document.body,this._nDelay=1800,this._nDistance=10,this._nX=0,this._nY=0,this._nOriginalX=0,this._nOriginalY=0,this._dragging=!1,this._eElement.addEventListener("pointerdown",this._pointerDownEventListener,{passive:!0})}destroy(){this.checkRemovePointerTrackingEventListeners(),this._eElement.removeEventListener("pointerdown",this._pointerDownEventListener)}cancelDrag(){this.processDragStop(void 0)}onPointerDown(e){if(this._allowableTargets.includes(e.target)&&e.isPrimary){let t=this.getPointerCoordinates(e);this.processPointerDown(t)}}processPointerDown(e){this._nOriginalX=e.x,this._nOriginalY=e.y,this._oDocument.addEventListener("pointermove",this._pointerMoveEventListener),this._oDocument.addEventListener("pointerup",this._pointerUpEventListener,{passive:!0}),this._pointerTracking=!0,this._timeout=setTimeout(()=>{try{this.startDrag()}catch(t){throw console.error(t),t}},this._nDelay)}onPointerMove(e){this._pointerTracking&&(this.processDragMove(e),e.preventDefault())}processDragMove(e){this._nX=e.pageX-this._nOriginalX,this._nY=e.pageY-this._nOriginalY,this._dragging===!1&&(Math.abs(this._nX)>this._nDistance||Math.abs(this._nY)>this._nDistance)&&this.startDrag(),this._dragging&&this.emit("drag",this._nX,this._nY,e)}onPointerUp(e){this.processDragStop(e)}processDragStop(e){var t;this._timeout!==void 0&&(clearTimeout(this._timeout),this._timeout=void 0),this.checkRemovePointerTrackingEventListeners(),this._dragging===!0&&(this._eBody.classList.remove("lm_dragging"),this._eElement.classList.remove("lm_dragging"),(t=this._oDocument.querySelector("iframe"))===null||t===void 0||t.style.setProperty("pointer-events",""),this._dragging=!1,this.emit("dragStop",e))}checkRemovePointerTrackingEventListeners(){this._pointerTracking&&(this._oDocument.removeEventListener("pointermove",this._pointerMoveEventListener),this._oDocument.removeEventListener("pointerup",this._pointerUpEventListener),this._pointerTracking=!1)}startDrag(){var e;this._timeout!==void 0&&(clearTimeout(this._timeout),this._timeout=void 0),this._dragging=!0,this._eBody.classList.add("lm_dragging"),this._eElement.classList.add("lm_dragging"),(e=this._oDocument.querySelector("iframe"))===null||e===void 0||e.style.setProperty("pointer-events","none"),this.emit("dragStart",this._nOriginalX,this._nOriginalY)}getPointerCoordinates(e){return{x:e.pageX,y:e.pageY}}};var Ne=class{constructor(e,t,n){this._isVertical=e,this._size=t,this._grabSize=n<this._size?this._size:n,this._element=document.createElement("div"),this._element.classList.add("lm_splitter");let i=document.createElement("div");i.classList.add("lm_drag_handle");let s=this._grabSize-this._size,r=s/2;this._isVertical?(i.style.top=b(-r),i.style.height=b(this._size+s),this._element.classList.add("lm_vertical"),this._element.style.height=b(this._size)):(i.style.left=b(-r),i.style.width=b(this._size+s),this._element.classList.add("lm_horizontal"),this._element.style.width=b(this._size)),this._element.appendChild(i),this._dragListener=new ae(this._element,[i])}get element(){return this._element}destroy(){this._element.remove()}on(e,t){this._dragListener.on(e,t)}};var ne=class o extends A{constructor(e,t,n,i){switch(super(t,n,i,o.createElement(document,e)),this._rowOrColumnParent=i,this._splitter=[],this.isRow=!e,this.isColumn=e,this._childElementContainer=this.element,this._splitterSize=t.layoutConfig.dimensions.borderWidth,this._splitterGrabSize=t.layoutConfig.dimensions.borderGrabWidth,this._isColumn=e,this._dimension=e?"height":"width",this._splitterPosition=null,this._splitterMinPosition=null,this._splitterMaxPosition=null,n.type){case p.row:case p.column:this._configType=n.type;break;default:throw new v("ROCCCT00925")}}newComponent(e,t,n,i){let s={type:"component",componentType:e,componentState:t,title:n};return this.newItem(s,i)}addComponent(e,t,n,i){let s={type:"component",componentType:e,componentState:t,title:n};return this.addItem(s,i)}newItem(e,t){t=this.addItem(e,t);let n=this.contentItems[t];return A.isStack(n)&&x.isComponent(e)?n.contentItems[0]:n}addItem(e,t){this.layoutManager.checkMinimiseMaximisedStack();let n=x.resolve(e,!1),i=this.layoutManager.createAndInitContentItem(n,this);return this.addChild(i,t,!1)}addChild(e,t,n){if(t===void 0&&(t=this.contentItems.length),this.contentItems.length>0){let s=this.createSplitter(Math.max(0,t-1)).element;t>0?(this.contentItems[t-1].element.insertAdjacentElement("afterend",s),s.insertAdjacentElement("afterend",e.element)):(this.contentItems[0].element.insertAdjacentElement("beforebegin",s),s.insertAdjacentElement("beforebegin",e.element))}else this._childElementContainer.appendChild(e.element);super.addChild(e,t);let i=1/this.contentItems.length*100;if(n===!0)return this.emitBaseBubblingEvent("stateChanged"),t;for(let s=0;s<this.contentItems.length;s++){let r=this.contentItems[s];if(r===e)e.size=i;else{let a=r.size*=(100-i)/100;r.size=a}}return this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged"),t}removeChild(e,t){let n=this.contentItems.indexOf(e),i=Math.max(n-1,0);if(n===-1)throw new Error("Can't remove child. ContentItem is not child of this Row or Column");if(this._splitter[i]&&(this._splitter[i].destroy(),this._splitter.splice(i,1)),super.removeChild(e,t),this.contentItems.length===1&&this.isClosable===!0){let s=this.contentItems[0];this.contentItems.length=0,this._rowOrColumnParent.replaceChild(this,s,!0)}else this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged")}replaceChild(e,t){let n=e.size;super.replaceChild(e,t),t.size=n,this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged")}updateSize(e){this.layoutManager.beginVirtualSizedContainerAdding();try{this.updateNodeSize(),this.updateContentItemsSize(e)}finally{this.layoutManager.endVirtualSizedContainerAdding()}}init(){if(this.isInitialised!==!0){this.updateNodeSize();for(let e=0;e<this.contentItems.length;e++)this._childElementContainer.appendChild(this.contentItems[e].element);super.init();for(let e=0;e<this.contentItems.length-1;e++)this.contentItems[e].element.insertAdjacentElement("afterend",this.createSplitter(e).element);this.initContentItems()}}toConfig(){return{type:this.type,content:this.calculateConfigContent(),size:this.size,sizeUnit:this.sizeUnit,minSize:this.minSize,minSizeUnit:this.minSizeUnit,id:this.id,isClosable:this.isClosable}}setParent(e){this._rowOrColumnParent=e,super.setParent(e)}updateNodeSize(){this.contentItems.length>0&&(this.calculateRelativeSizes(),this.setAbsoluteSizes()),this.emitBaseBubblingEvent("stateChanged"),this.emit("resize")}setAbsoluteSizes(){let e=this.calculateAbsoluteSizes();for(let t=0;t<this.contentItems.length;t++)e.additionalPixel-t>0&&e.itemSizes[t]++,this._isColumn?(R(this.contentItems[t].element,e.crossAxisSize),k(this.contentItems[t].element,e.itemSizes[t])):(R(this.contentItems[t].element,e.itemSizes[t]),k(this.contentItems[t].element,e.crossAxisSize))}calculateAbsoluteSizes(){let e=(this.contentItems.length-1)*this._splitterSize,{width:t,height:n}=V(this.element),i,s;this._isColumn?(i=n-e,s=t):(i=t-e,s=n);let r=0,a=[];for(let d=0;d<this.contentItems.length;d++){let u=this.contentItems[d],c;if(u.sizeUnit===S.Percent)c=Math.floor(i*(u.size/100));else throw new v("ROCCAS6692");r+=c,a.push(c)}let l=Math.floor(i-r);return{itemSizes:a,additionalPixel:l,totalSize:i,crossAxisSize:s}}calculateRelativeSizes(){let e=0,t=[],n=0;for(let i=0;i<this.contentItems.length;i++){let s=this.contentItems[i];switch(s.sizeUnit){case S.Percent:{e+=s.size;break}case S.Fractional:{t.push(s),n+=s.size;break}default:throw new v("ROCCRS49110",JSON.stringify(s))}}if(Math.round(e)===100){this.respectMinItemSize();return}else if(Math.round(e)<100&&t.length>0){let i=100-e;for(let s=0;s<t.length;s++){let r=t[s];r.size=i*(r.size/n),r.sizeUnit=S.Percent}this.respectMinItemSize();return}else{if(Math.round(e)>100&&t.length>0){for(let i=0;i<t.length;i++){let s=t[i];s.size=50*(s.size/n),s.sizeUnit=S.Percent}e+=50}for(let i=0;i<this.contentItems.length;i++){let s=this.contentItems[i];s.size=s.size/e*100}this.respectMinItemSize()}}respectMinItemSize(){let e=this.calculateContentItemMinSize(this);if(!(e<=0||this.contentItems.length<=1)){let t=0,n=0,i=[],s=[],r=this.calculateAbsoluteSizes();for(let a=0;a<r.itemSizes.length;a++){let l=r.itemSizes[a],d;l<e?(n+=e-l,d={size:e}):(t+=l-e,d={size:l},i.push(d)),s.push(d)}if(n===0||n>t)return;{let a=n/t,l=n;for(let d=0;d<i.length;d++){let u=i[d],c=Math.round((u.size-e)*a);l-=c,u.size-=c}l!==0&&(s[s.length-1].size-=l);for(let d=0;d<this.contentItems.length;d++){let u=this.contentItems[d];u.size=s[d].size/r.totalSize*100}}}}createSplitter(e){let t=new Ne(this._isColumn,this._splitterSize,this._splitterGrabSize);return t.on("drag",(n,i)=>this.onSplitterDrag(t,n,i)),t.on("dragStop",()=>this.onSplitterDragStop(t)),t.on("dragStart",()=>this.onSplitterDragStart(t)),this._splitter.splice(e,0,t),t}getSplitItems(e){let t=this._splitter.indexOf(e);return{before:this.contentItems[t],after:this.contentItems[t+1]}}calculateContentItemMinSize(e){let t=e.minSize;if(t!==void 0){if(e.minSizeUnit===S.Pixel)return t;throw new v("ROCGMD98831",JSON.stringify(e))}else{let n=this.layoutManager.layoutConfig.dimensions;return this._isColumn?n.defaultMinItemHeight:n.defaultMinItemWidth}}calculateContentItemsTotalMinSize(e){let t=0;for(let n of e)t+=this.calculateContentItemMinSize(n);return t}onSplitterDragStart(e){let t=this.getSplitItems(e),n=oe(t.before.element.style[this._dimension]),i=oe(t.after.element.style[this._dimension]),s=this.calculateContentItemsTotalMinSize(t.before.contentItems),r=this.calculateContentItemsTotalMinSize(t.after.contentItems);this._splitterPosition=0,this._splitterMinPosition=-1*(n-s),this._splitterMaxPosition=i-r}onSplitterDrag(e,t,n){let i=this._isColumn?n:t;if(this._splitterMinPosition===null||this._splitterMaxPosition===null)throw new w("ROCOSD59226");i=Math.max(i,this._splitterMinPosition),i=Math.min(i,this._splitterMaxPosition),this._splitterPosition=i;let s=b(i);this._isColumn?e.element.style.top=s:e.element.style.left=s}onSplitterDragStop(e){if(this._splitterPosition===null)throw new w("ROCOSDS66932");{let t=this.getSplitItems(e),n=oe(t.before.element.style[this._dimension]),i=oe(t.after.element.style[this._dimension]),s=(this._splitterPosition+n)/(n+i),r=t.before.size+t.after.size;t.before.size=s*r,t.after.size=(1-s)*r,e.element.style.top=b(0),e.element.style.left=b(0),globalThis.requestAnimationFrame(()=>this.updateSize(!1))}}};(function(o){function e(i,s){return s==="width"?_t(i):gt(i)}o.getElementDimensionSize=e;function t(i,s,r){return s==="width"?R(i,r):k(i,r)}o.setElementDimensionSize=t;function n(i,s){let r=i.createElement("div");return r.classList.add("lm_item"),s?r.classList.add("lm_column"):r.classList.add("lm_row"),r}o.createElement=n})(ne||(ne={}));var ie=class o extends Ce{constructor(e,t,n){super(e,We.create(t),null,o.createElement(document)),this.isGround=!0,this._childElementContainer=this.element,this._containerElement=n;let i=null;for(;;){let s=i?i.previousSibling:this._containerElement.lastChild;if(s instanceof Element&&s.classList.contains("lm_content"))i=s;else break}this._containerElement.insertBefore(this.element,i)}init(){if(this.isInitialised!==!0){this.updateNodeSize();for(let e=0;e<this.contentItems.length;e++)this._childElementContainer.appendChild(this.contentItems[e].element);super.init(),this.initContentItems()}}loadRoot(e){if(this.clearRoot(),e!==void 0){let t=this.layoutManager.createAndInitContentItem(e,this);this.addChild(t,0)}}clearRoot(){let e=this.contentItems;switch(e.length){case 0:return;case 1:{e[0].remove();return}default:throw new v("GILR07721")}}addItem(e,t){this.layoutManager.checkMinimiseMaximisedStack();let n=x.resolve(e,!1),i;if(this.contentItems.length>0?i=this.contentItems[0]:i=this,i.isComponent)throw new Error("Cannot add item as child to ComponentItem");{let s=this.layoutManager.createAndInitContentItem(n,i);return t=i.addChild(s,t),i===this?-1:t}}loadComponentAsRoot(e){this.clearRoot();let t=x.resolve(e,!1);if(t.maximised)throw new Error("Root Component cannot be maximised");{let n=new G(this.layoutManager,t,this);n.init(),this.addChild(n,0)}}addChild(e,t){if(this.contentItems.length>0)throw new Error("Ground node can only have a single child");return this._childElementContainer.appendChild(e.element),t=super.addChild(e,t),this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged"),t}calculateConfigContent(){let e=this.contentItems,t=e.length,n=new Array(t);for(let i=0;i<t;i++){let r=e[i].toConfig();if(K.isRootItemConfig(r))n[i]=r;else throw new v("RCCC66832")}return n}setSize(e,t){e===void 0||t===void 0?this.updateSize(!1):(R(this.element,e),k(this.element,t),this.contentItems.length>0&&(R(this.contentItems[0].element,e),k(this.contentItems[0].element,t)),this.updateContentItemsSize(!1))}updateSize(e){this.layoutManager.beginVirtualSizedContainerAdding();try{this.updateNodeSize(),this.updateContentItemsSize(e)}finally{this.layoutManager.endVirtualSizedContainerAdding()}}createSideAreas(){let t=o.Area.oppositeSides,n=new Array(Object.keys(t).length),i=0;for(let s in t){let r=s,a=this.getElementArea();if(a===null)throw new w("RCSA77553");a.side=r,t[r][1]==="2"?a[r]=a[t[r]]-50:a[r]=a[t[r]]+50,a.surface=(a.x2-a.x1)*(a.y2-a.y1),n[i++]=a}return n}highlightDropZone(e,t,n){this.layoutManager.tabDropPlaceholder.remove(),super.highlightDropZone(e,t,n)}onDrop(e,t){if(e.isComponent){let n=q.createDefault(),i=e;n.header=W.Header.createCopy(i.headerConfig);let s=this.layoutManager.createAndInitContentItem(n,this);s.addChild(e),e=s}if(this.contentItems.length===0)this.addChild(e);else{if(e.type===p.row||e.type===p.column){let r=q.createDefault(),a=this.layoutManager.createContentItem(r,this);a.addChild(e),e=a}let n=t.side[0]=="x"?p.row:p.column,i=t.side[1]=="2",s=this.contentItems[0];if(!(s instanceof ne)||s.type!==n){let r=y.createDefault(n),a=this.layoutManager.createContentItem(r,this);this.replaceChild(s,a),a.addChild(e,i?0:void 0,!0),a.addChild(s,i?void 0:0,!0),s.size=50,e.size=50,e.sizeUnit=S.Percent,a.updateSize(!1)}else{let r=s.contentItems[i?0:s.contentItems.length-1];s.addChild(e,i?0:void 0,!0),r.size*=.5,e.size=r.size,e.sizeUnit=S.Percent,s.updateSize(!1)}}}dock(){throw new v("GID87731")}validateDocking(){throw new v("GIVD87732")}getAllContentItems(){let e=[this];return this.deepGetAllContentItems(this.contentItems,e),e}getConfigMaximisedItems(){let e=[];return this.deepFilterContentItems(this.contentItems,e,t=>A.isStack(t)&&t.initialWantMaximise?!0:!!(A.isComponentItem(t)&&t.initialWantMaximise)),e}getItemsByPopInParentId(e){let t=[];return this.deepFilterContentItems(this.contentItems,t,n=>n.popInParentIds.includes(e)),t}toConfig(){throw new Error("Cannot generate GroundItem config")}setActiveComponentItem(e,t,n){}updateNodeSize(){let{width:e,height:t}=V(this._containerElement);R(this.element,e),k(this.element,t),this.contentItems.length>0&&(R(this.contentItems[0].element,e),k(this.contentItems[0].element,t))}deepGetAllContentItems(e,t){for(let n=0;n<e.length;n++){let i=e[n];t.push(i),this.deepGetAllContentItems(i.contentItems,t)}}deepFilterContentItems(e,t,n){for(let i=0;i<e.length;i++){let s=e[i];n(s)&&t.push(s),this.deepFilterContentItems(s.contentItems,t,n)}}};(function(o){let e;(function(n){n.oppositeSides={y2:"y1",x2:"x1",y1:"y2",x1:"x2"}})(e=o.Area||(o.Area={}));function t(n){let i=n.createElement("div");return i.classList.add("lm_goldenlayout"),i.classList.add("lm_item"),i.classList.add("lm_root"),i}o.createElement=t})(ie||(ie={}));var he=class{constructor(e,t,n,i){this._header=e,this._pushEvent=i,this._clickEventListener=s=>this.onClick(s),this._touchStartEventListener=s=>this.onTouchStart(s),this._element=document.createElement("div"),this._element.classList.add(n),this._element.title=t,this._header.on("destroy",()=>this.destroy()),this._element.addEventListener("click",this._clickEventListener,{passive:!0}),this._element.addEventListener("touchstart",this._touchStartEventListener,{passive:!0}),this._header.controlsContainerElement.appendChild(this._element)}get element(){return this._element}destroy(){var e;this._element.removeEventListener("click",this._clickEventListener),this._element.removeEventListener("touchstart",this._touchStartEventListener),(e=this._element.parentNode)===null||e===void 0||e.removeChild(this._element)}onClick(e){this._pushEvent(e)}onTouchStart(e){this._pushEvent(e)}};var Ge=class{constructor(e,t,n,i,s){var r;this._layoutManager=e,this._componentItem=t,this._closeEvent=n,this._focusEvent=i,this._dragStartEvent=s,this._isActive=!1,this._tabClickListener=l=>this.onTabClickDown(l),this._tabTouchStartListener=l=>this.onTabTouchStart(l),this._closeClickListener=()=>this.onCloseClick(),this._closeTouchStartListener=()=>this.onCloseTouchStart(),this._dragStartListener=(l,d)=>this.onDragStart(l,d),this._contentItemDestroyListener=()=>this.onContentItemDestroy(),this._tabTitleChangedListener=l=>this.setTitle(l),this._element=document.createElement("div"),this._element.classList.add("lm_tab"),this._titleElement=document.createElement("span"),this._titleElement.classList.add("lm_title"),this._closeElement=document.createElement("div"),this._closeElement.classList.add("lm_close_tab"),this._element.appendChild(this._titleElement),this._element.appendChild(this._closeElement),t.isClosable?this._closeElement.style.display="":this._closeElement.style.display="none",this.setTitle(t.title),this._componentItem.on("titleChanged",this._tabTitleChangedListener),((r=t.reorderEnabled)!==null&&r!==void 0?r:this._layoutManager.layoutConfig.settings.reorderEnabled)&&this.enableReorder(),this._element.addEventListener("click",this._tabClickListener,{passive:!0}),this._element.addEventListener("touchstart",this._tabTouchStartListener,{passive:!0}),this._componentItem.isClosable?(this._closeElement.addEventListener("click",this._closeClickListener,{passive:!0}),this._closeElement.addEventListener("touchstart",this._closeTouchStartListener,{passive:!0})):(this._closeElement.remove(),this._closeElement=void 0),this._componentItem.setTab(this),this._layoutManager.emit("tabCreated",this)}get isActive(){return this._isActive}get componentItem(){return this._componentItem}get contentItem(){return this._componentItem}get element(){return this._element}get titleElement(){return this._titleElement}get closeElement(){return this._closeElement}get reorderEnabled(){return this._dragListener!==void 0}set reorderEnabled(e){e!==this.reorderEnabled&&(e?this.enableReorder():this.disableReorder())}setTitle(e){this._titleElement.innerText=e,this._element.title=e}setActive(e){e!==this._isActive&&(this._isActive=e,e?this._element.classList.add("lm_active"):this._element.classList.remove("lm_active"))}destroy(){var e,t;this._closeEvent=void 0,this._focusEvent=void 0,this._dragStartEvent=void 0,this._element.removeEventListener("click",this._tabClickListener),this._element.removeEventListener("touchstart",this._tabTouchStartListener),(e=this._closeElement)===null||e===void 0||e.removeEventListener("click",this._closeClickListener),(t=this._closeElement)===null||t===void 0||t.removeEventListener("touchstart",this._closeTouchStartListener),this._componentItem.off("titleChanged",this._tabTitleChangedListener),this.reorderEnabled&&this.disableReorder(),this._element.remove()}setBlurred(){this._element.classList.remove("lm_focused"),this._titleElement.classList.remove("lm_focused")}setFocused(){this._element.classList.add("lm_focused"),this._titleElement.classList.add("lm_focused")}onDragStart(e,t){if(this._dragListener===void 0)throw new g("TODSDLU10093");if(this._dragStartEvent===void 0)throw new g("TODS23309");this._dragStartEvent(e,t,this._dragListener,this.componentItem)}onContentItemDestroy(){this._dragListener!==void 0&&(this._dragListener.destroy(),this._dragListener=void 0)}onTabClickDown(e){let t=e.target;(t===this._element||t===this._titleElement)&&(e.button===0?this.notifyFocus():e.button===1&&this._componentItem.isClosable&&this.notifyClose())}onTabTouchStart(e){e.target===this._element&&this.notifyFocus()}onCloseClick(){this.notifyClose()}onCloseTouchStart(){this.notifyClose()}notifyClose(){if(this._closeEvent===void 0)throw new g("TNC15007");this._closeEvent(this._componentItem)}notifyFocus(){if(this._focusEvent===void 0)throw new g("TNA15007");this._focusEvent(this._componentItem)}enableReorder(){this._dragListener=new ae(this._element,[this._titleElement]),this._dragListener.on("dragStart",this._dragStartListener),this._componentItem.on("destroy",this._contentItemDestroyListener)}disableReorder(){if(this._dragListener===void 0)throw new g("TDR87745");this._componentItem.off("destroy",this._contentItemDestroyListener),this._dragListener.off("dragStart",this._dragStartListener),this._dragListener=void 0}};var Ze=class{constructor(e,t,n,i,s){this._layoutManager=e,this._componentRemoveEvent=t,this._componentFocusEvent=n,this._componentDragStartEvent=i,this._dropdownActiveChangedEvent=s,this._tabs=[],this._lastVisibleTabIndex=-1,this._dropdownActive=!1,this._element=document.createElement("section"),this._element.classList.add("lm_tabs"),this._dropdownElement=document.createElement("section"),this._dropdownElement.classList.add("lm_tabdropdown_list"),this._dropdownElement.style.display="none"}get tabs(){return this._tabs}get tabCount(){return this._tabs.length}get lastVisibleTabIndex(){return this._lastVisibleTabIndex}get element(){return this._element}get dropdownElement(){return this._dropdownElement}get dropdownActive(){return this._dropdownActive}destroy(){for(let e=0;e<this._tabs.length;e++)this._tabs[e].destroy()}createTab(e,t){for(let i=0;i<this._tabs.length;i++)if(this._tabs[i].componentItem===e)return;let n=new Ge(this._layoutManager,e,i=>this.handleTabCloseEvent(i),i=>this.handleTabFocusEvent(i),(i,s,r,a)=>this.handleTabDragStartEvent(i,s,r,a));t===void 0&&(t=this._tabs.length),this._tabs.splice(t,0,n),t<this._element.childNodes.length?this._element.insertBefore(n.element,this._element.childNodes[t]):this._element.appendChild(n.element)}removeTab(e){for(let t=0;t<this._tabs.length;t++)if(this._tabs[t].componentItem===e){this._tabs[t].destroy(),this._tabs.splice(t,1);return}throw new Error("contentItem is not controlled by this header")}processActiveComponentChanged(e){let t=-1;for(let n=0;n<this._tabs.length;n++){let i=this._tabs[n].componentItem===e;this._tabs[n].setActive(i),i&&(t=n)}if(t<0)throw new v("HSACI56632");if(this._layoutManager.layoutConfig.settings.reorderOnTabMenuClick&&this._lastVisibleTabIndex!==-1&&t>this._lastVisibleTabIndex){let n=this._tabs[t];for(let i=t;i>0;i--)this._tabs[i]=this._tabs[i-1];this._tabs[0]=n}}updateTabSizes(e,t){let n=!1;this.tryUpdateTabSizes(n,e,t)||(n=!0,this.tryUpdateTabSizes(n,e,t)),n!==this._dropdownActive&&(this._dropdownActive=n,this._dropdownActiveChangedEvent())}tryUpdateTabSizes(e,t,n){if(this._tabs.length>0){if(n===void 0)throw new Error("non-empty tabs must have active component item");let i=0,s=!1,r=this._layoutManager.layoutConfig.settings.tabOverlapAllowance,a=this._tabs.indexOf(n.tab),l=this._tabs[a];this._lastVisibleTabIndex=-1;for(let d=0;d<this._tabs.length;d++){let u=this._tabs[d].element;u.parentElement!==this._element&&this._element.appendChild(u);let c=getComputedStyle(l.element).marginRight,h=oe(c),m=u.offsetWidth+h;i+=m;let f=0;if(a<=d)f=i;else{let _=getComputedStyle(l.element).marginRight,I=oe(_);f=i+l.element.offsetWidth+I}if(f>t){if(s)d===a&&(u.style.zIndex="auto",u.style.marginLeft="",u.parentElement!==this._element&&this._element.appendChild(u));else{let _;if(a>0&&a<=d?_=(f-t)/(d-1):_=(f-t)/d,_<r){for(let I=0;I<=d;I++){let E=I!==a&&I!==0?"-"+b(_):"";this._tabs[I].element.style.zIndex=b(d-I),this._tabs[I].element.style.marginLeft=E}this._lastVisibleTabIndex=d,u.parentElement!==this._element&&this._element.appendChild(u)}else s=!0}if(s&&d!==a)if(e)u.style.zIndex="auto",u.style.marginLeft="",u.parentElement!==this._dropdownElement&&this._dropdownElement.appendChild(u);else return!1}else this._lastVisibleTabIndex=d,u.style.zIndex="auto",u.style.marginLeft="",u.parentElement!==this._element&&this._element.appendChild(u)}}return!0}showAdditionalTabsDropdown(){this._dropdownElement.style.display=""}hideAdditionalTabsDropdown(){this._dropdownElement.style.display="none"}handleTabCloseEvent(e){this._componentRemoveEvent(e)}handleTabFocusEvent(e){this._componentFocusEvent(e)}handleTabDragStartEvent(e,t,n,i){this._componentDragStartEvent(e,t,n,i)}};var qe=class extends z{constructor(e,t,n,i,s,r,a,l,d,u,c,h,m){super(),this._layoutManager=e,this._parent=t,this._configClosable=i,this._getActiveComponentItemEvent=s,this._popoutEvent=a,this._maximiseToggleEvent=l,this._clickEvent=d,this._touchStartEvent=u,this._componentRemoveEvent=c,this._componentFocusEvent=h,this._componentDragStartEvent=m,this._clickListener=f=>this.onClick(f),this._touchStartListener=f=>this.onTouchStart(f),this._rowColumnClosable=!0,this._closeButton=null,this._popoutButton=null,this._tabsContainer=new Ze(this._layoutManager,f=>this.handleTabInitiatedComponentRemoveEvent(f),f=>this.handleTabInitiatedComponentFocusEvent(f),(f,_,I,E)=>this.handleTabInitiatedDragStartEvent(f,_,I,E),()=>this.processTabDropdownActiveChanged()),this._show=n.show,this._popoutEnabled=n.popoutEnabled,this._popoutLabel=n.popoutLabel,this._maximiseEnabled=n.maximiseEnabled,this._maximiseLabel=n.maximiseLabel,this._minimiseEnabled=n.minimiseEnabled,this._minimiseLabel=n.minimiseLabel,this._closeEnabled=n.closeEnabled,this._closeLabel=n.closeLabel,this._tabDropdownEnabled=n.tabDropdownEnabled,this._tabDropdownLabel=n.tabDropdownLabel,this.setSide(n.side),this._canRemoveComponent=this._configClosable,this._element=document.createElement("section"),this._element.classList.add("lm_header"),this._controlsContainerElement=document.createElement("section"),this._controlsContainerElement.classList.add("lm_controls"),this._element.appendChild(this._tabsContainer.element),this._element.appendChild(this._controlsContainerElement),this._element.appendChild(this._tabsContainer.dropdownElement),this._element.addEventListener("click",this._clickListener,{passive:!0}),this._element.addEventListener("touchstart",this._touchStartListener,{passive:!0}),this._documentMouseUpListener=()=>this._tabsContainer.hideAdditionalTabsDropdown(),globalThis.document.addEventListener("mouseup",this._documentMouseUpListener,{passive:!0}),this._tabControlOffset=this._layoutManager.layoutConfig.settings.tabControlOffset,this._tabDropdownEnabled&&(this._tabDropdownButton=new he(this,this._tabDropdownLabel,"lm_tabdropdown",()=>this._tabsContainer.showAdditionalTabsDropdown())),this._popoutEnabled&&(this._popoutButton=new he(this,this._popoutLabel,"lm_popout",()=>this.handleButtonPopoutEvent())),this._maximiseEnabled&&(this._maximiseButton=new he(this,this._maximiseLabel,"lm_maximise",f=>this.handleButtonMaximiseToggleEvent(f))),this._configClosable&&(this._closeButton=new he(this,this._closeLabel,"lm_close",()=>r())),this.processTabDropdownActiveChanged()}get show(){return this._show}get side(){return this._side}get leftRightSided(){return this._leftRightSided}get layoutManager(){return this._layoutManager}get parent(){return this._parent}get tabs(){return this._tabsContainer.tabs}get lastVisibleTabIndex(){return this._tabsContainer.lastVisibleTabIndex}get element(){return this._element}get tabsContainerElement(){return this._tabsContainer.element}get controlsContainerElement(){return this._controlsContainerElement}destroy(){this.emit("destroy"),this._popoutEvent=void 0,this._maximiseToggleEvent=void 0,this._clickEvent=void 0,this._touchStartEvent=void 0,this._componentRemoveEvent=void 0,this._componentFocusEvent=void 0,this._componentDragStartEvent=void 0,this._tabsContainer.destroy(),globalThis.document.removeEventListener("mouseup",this._documentMouseUpListener),this._element.remove()}createTab(e,t){this._tabsContainer.createTab(e,t)}removeTab(e){this._tabsContainer.removeTab(e)}processActiveComponentChanged(e){this._tabsContainer.processActiveComponentChanged(e),this.updateTabSizes()}setSide(e){this._side=e,this._leftRightSided=[X.right,X.left].includes(this._side)}setRowColumnClosable(e){this._rowColumnClosable=e,this.updateClosability()}updateClosability(){let e;if(!this._configClosable)e=!1;else if(!this._rowColumnClosable)e=!1;else{e=!0;let t=this.tabs.length;for(let n=0;n<t;n++)if(!this._tabsContainer.tabs[n].componentItem.isClosable){e=!1;break}}this._closeButton!==null&&N(this._closeButton.element,e),this._popoutButton!==null&&N(this._popoutButton.element,e),this._canRemoveComponent=e||this._tabsContainer.tabCount>1}applyFocusedValue(e){e?this._element.classList.add("lm_focused"):this._element.classList.remove("lm_focused")}processMaximised(){if(this._maximiseButton===void 0)throw new g("HPMAX16997");this._maximiseButton.element.setAttribute("title",this._minimiseLabel)}processMinimised(){if(this._maximiseButton===void 0)throw new g("HPMIN16997");this._maximiseButton.element.setAttribute("title",this._maximiseLabel)}updateTabSizes(){if(this._tabsContainer.tabCount>0){let e=this._show?this._layoutManager.layoutConfig.dimensions.headerHeight:0;this._leftRightSided?(this._element.style.height="",this._element.style.width=b(e)):(this._element.style.width="",this._element.style.height=b(e));let t;this._leftRightSided?t=this._element.offsetHeight-this._controlsContainerElement.offsetHeight-this._tabControlOffset:t=this._element.offsetWidth-this._controlsContainerElement.offsetWidth-this._tabControlOffset,this._tabsContainer.updateTabSizes(t,this._getActiveComponentItemEvent())}}handleTabInitiatedComponentRemoveEvent(e){if(this._canRemoveComponent){if(this._componentRemoveEvent===void 0)throw new g("HHTCE22294");this._componentRemoveEvent(e)}}handleTabInitiatedComponentFocusEvent(e){if(this._componentFocusEvent===void 0)throw new g("HHTAE22294");this._componentFocusEvent(e)}handleTabInitiatedDragStartEvent(e,t,n,i){if(!this._canRemoveComponent)n.cancelDrag();else{if(this._componentDragStartEvent===void 0)throw new g("HHTDSE22294");this._componentDragStartEvent(e,t,n,i)}}processTabDropdownActiveChanged(){this._tabDropdownButton!==void 0&&N(this._tabDropdownButton.element,this._tabsContainer.dropdownActive)}handleButtonPopoutEvent(){if(this._layoutManager.layoutConfig.settings.popoutWholeStack){if(this._popoutEvent===void 0)throw new g("HHBPOE17834");this._popoutEvent()}else{let e=this._getActiveComponentItemEvent();e&&e.popout()}}handleButtonMaximiseToggleEvent(e){if(this._maximiseToggleEvent===void 0)throw new g("HHBMTE16834");this._maximiseToggleEvent()}onClick(e){e.target===this._element&&this.notifyClick(e)}onTouchStart(e){e.target===this._element&&this.notifyTouchStart(e)}notifyClick(e){if(this._clickEvent===void 0)throw new g("HNHC46834");this._clickEvent(e)}notifyTouchStart(e){if(this._touchStartEvent===void 0)throw new g("HNHTS46834");this._touchStartEvent(e)}};var Y=class o extends Ce{constructor(e,t,n){var i,s,r,a,l,d,u,c,h,m,f,_,I,E,P,M,H,L,F;super(e,t,n,o.createElement(document)),this._headerSideChanged=!1,this._resizeListener=()=>this.handleResize(),this._maximisedListener=()=>this.handleMaximised(),this._minimisedListener=()=>this.handleMinimised(),this._headerConfig=t.header;let B=e.layoutConfig.header,le=t.content,T;le.length!==1?T=void 0:T=le[0].header,this._initialWantMaximise=t.maximised,this._initialActiveItemIndex=(i=t.activeItemIndex)!==null&&i!==void 0?i:0;let se=(a=(r=(s=this._headerConfig)===null||s===void 0?void 0:s.show)!==null&&r!==void 0?r:T?.show)!==null&&a!==void 0?a:B.show,Te=(u=(d=(l=this._headerConfig)===null||l===void 0?void 0:l.popout)!==null&&d!==void 0?d:T?.popout)!==null&&u!==void 0?u:B.popout,$e=(m=(h=(c=this._headerConfig)===null||c===void 0?void 0:c.maximise)!==null&&h!==void 0?h:T?.maximise)!==null&&m!==void 0?m:B.maximise,Ae=(I=(_=(f=this._headerConfig)===null||f===void 0?void 0:f.close)!==null&&_!==void 0?_:T?.close)!==null&&I!==void 0?I:B.close,St=(M=(P=(E=this._headerConfig)===null||E===void 0?void 0:E.minimise)!==null&&P!==void 0?P:T?.minimise)!==null&&M!==void 0?M:B.minimise,Ye=(F=(L=(H=this._headerConfig)===null||H===void 0?void 0:H.tabDropdown)!==null&&L!==void 0?L:T?.tabDropdown)!==null&&F!==void 0?F:B.tabDropdown;this._maximisedEnabled=$e!==!1;let xt={show:se!==!1,side:se===!1?X.top:se,popoutEnabled:Te!==!1,popoutLabel:Te===!1?"":Te,maximiseEnabled:this._maximisedEnabled,maximiseLabel:$e===!1?"":$e,closeEnabled:Ae!==!1,closeLabel:Ae===!1?"":Ae,minimiseEnabled:!0,minimiseLabel:St,tabDropdownEnabled:Ye!==!1,tabDropdownLabel:Ye===!1?"":Ye};this._header=new qe(e,this,xt,t.isClosable&&Ae!==!1,()=>this.getActiveComponentItem(),()=>this.remove(),()=>this.handlePopoutEvent(),()=>this.toggleMaximise(),J=>this.handleHeaderClickEvent(J),J=>this.handleHeaderTouchStartEvent(J),J=>this.handleHeaderComponentRemoveEvent(J),J=>this.handleHeaderComponentFocusEvent(J),(J,zt,Mt,Pt)=>this.handleHeaderComponentStartDragEvent(J,zt,Mt,Pt)),this.isStack=!0,this._childElementContainer=document.createElement("section"),this._childElementContainer.classList.add("lm_items"),this.on("resize",this._resizeListener),this._maximisedEnabled&&(this.on("maximised",this._maximisedListener),this.on("minimised",this._minimisedListener)),this.element.appendChild(this._header.element),this.element.appendChild(this._childElementContainer),this.setupHeaderPosition(),this._header.updateClosability()}get childElementContainer(){return this._childElementContainer}get header(){return this._header}get headerShow(){return this._header.show}get headerSide(){return this._header.side}get headerLeftRightSided(){return this._header.leftRightSided}get contentAreaDimensions(){return this._contentAreaDimensions}get initialWantMaximise(){return this._initialWantMaximise}get isMaximised(){return this===this.layoutManager.maximisedStack}get stackParent(){if(!this.parent)throw new Error("Stack should always have a parent");return this.parent}updateSize(e){this.layoutManager.beginVirtualSizedContainerAdding();try{this.updateNodeSize(),this.updateContentItemsSize(e)}finally{this.layoutManager.endVirtualSizedContainerAdding()}}init(){if(this.isInitialised===!0)return;this.updateNodeSize();for(let n=0;n<this.contentItems.length;n++)this._childElementContainer.appendChild(this.contentItems[n].element);super.init();let e=this.contentItems,t=e.length;if(t>0){if(this._initialActiveItemIndex<0||this._initialActiveItemIndex>=t)throw new Error(`ActiveItemIndex out of range: ${this._initialActiveItemIndex} id: ${this.id}`);for(let n=0;n<t;n++){let i=e[n];if(i instanceof G)this._header.createTab(i,n),i.hide(),i.container.setBaseLogicalZIndex();else throw new Error(`Stack Content Item is not of type ComponentItem: ${n} id: ${this.id}`)}this.setActiveComponentItem(e[this._initialActiveItemIndex],!1),this._header.updateTabSizes()}this._header.updateClosability(),this.initContentItems()}setActiveContentItem(e){if(A.isComponentItem(e))this.setActiveComponentItem(e,!1);else throw new Error("Stack.setActiveContentItem: item is not a ComponentItem")}setActiveComponentItem(e,t,n=!1){if(this._activeComponentItem!==e){if(this.contentItems.indexOf(e)===-1)throw new Error("componentItem is not a child of this stack");this.layoutManager.beginSizeInvalidation();try{this._activeComponentItem!==void 0&&this._activeComponentItem.hide(),this._activeComponentItem=e,this._header.processActiveComponentChanged(e),e.show()}finally{this.layoutManager.endSizeInvalidation()}this.emit("activeContentItemChanged",e),this.layoutManager.emit("activeContentItemChanged",e),this.emitStateChangedEvent()}(this.focused||t)&&this.layoutManager.setFocusedComponentItem(e,n)}getActiveContentItem(){var e;return(e=this.getActiveComponentItem())!==null&&e!==void 0?e:null}getActiveComponentItem(){return this._activeComponentItem}focusActiveContentItem(){var e;(e=this._activeComponentItem)===null||e===void 0||e.focus()}setFocusedValue(e){this._header.applyFocusedValue(e),super.setFocusedValue(e)}setRowColumnClosable(e){this._header.setRowColumnClosable(e)}newComponent(e,t,n,i){let s={type:"component",componentType:e,componentState:t,title:n};return this.newItem(s,i)}addComponent(e,t,n,i){let s={type:"component",componentType:e,componentState:t,title:n};return this.addItem(s,i)}newItem(e,t){return t=this.addItem(e,t),this.contentItems[t]}addItem(e,t){this.layoutManager.checkMinimiseMaximisedStack();let n=x.resolve(e,!1),i=this.layoutManager.createAndInitContentItem(n,this);return this.addChild(i,t)}addChild(e,t,n=!1){if(t!==void 0&&t>this.contentItems.length)throw t-=1,new v("SAC99728");if(e instanceof G)return t=super.addChild(e,t),this._childElementContainer.appendChild(e.element),this._header.createTab(e,t),this.setActiveComponentItem(e,n),this._header.updateTabSizes(),this.updateSize(!1),e.container.setBaseLogicalZIndex(),this._header.updateClosability(),this.emitStateChangedEvent(),t;throw new v("SACC88532")}removeChild(e,t){let n=e,i=this.contentItems.indexOf(n),s=this.contentItems.length===1;if(this._activeComponentItem===n&&(n.focused&&n.blur(),!s)){let r=i===0?1:i-1;this.setActiveComponentItem(this.contentItems[r],!1)}this._header.removeTab(n),super.removeChild(n,t),s||this._header.updateClosability(),this.emitStateChangedEvent()}toggleMaximise(){this.isMaximised?this.minimise():this.maximise()}maximise(){if(!this.isMaximised){this.layoutManager.setMaximisedStack(this);let e=this.contentItems,t=e.length;for(let n=0;n<t;n++){let i=e[n];if(i instanceof G)i.enterStackMaximised();else throw new v("SMAXI87773")}this.emitStateChangedEvent()}}minimise(){if(this.isMaximised){this.layoutManager.setMaximisedStack(void 0);let e=this.contentItems,t=e.length;for(let n=0;n<t;n++){let i=e[n];if(i instanceof G)i.exitStackMaximised();else throw new v("SMINI87773")}this.emitStateChangedEvent()}}destroy(){var e;!((e=this._activeComponentItem)===null||e===void 0)&&e.focused&&this._activeComponentItem.blur(),super.destroy(),this.off("resize",this._resizeListener),this._maximisedEnabled&&(this.off("maximised",this._maximisedListener),this.off("minimised",this._minimisedListener)),this._header.destroy()}toConfig(){let e;if(this._activeComponentItem&&(e=this.contentItems.indexOf(this._activeComponentItem),e<0))throw new Error("active component item not found in stack");if(this.contentItems.length>0&&e===void 0)throw new Error("expected non-empty stack to have an active component item");return{type:"stack",content:this.calculateConfigContent(),size:this.size,sizeUnit:this.sizeUnit,minSize:this.minSize,minSizeUnit:this.minSizeUnit,id:this.id,isClosable:this.isClosable,maximised:this.isMaximised,header:this.createHeaderConfig(),activeItemIndex:e}}onDrop(e,t){if(this._dropSegment==="header"){if(this.resetHeaderDropZone(),this._dropIndex===void 0)throw new g("SODDI68990");this.addChild(e,this._dropIndex);return}if(this._dropSegment==="body"){this.addChild(e,0,!0);return}let n=this._dropSegment==="top"||this._dropSegment==="bottom",i=this._dropSegment==="left"||this._dropSegment==="right",s=this._dropSegment==="top"||this._dropSegment==="left",r=n&&this.stackParent.isColumn||i&&this.stackParent.isRow;if(e.isComponent){let a=q.createDefault();a.header=this.createHeaderConfig();let l=this.layoutManager.createAndInitContentItem(a,this);l.addChild(e),e=l}if(e.type===p.row||e.type===p.column){let a=q.createDefault();a.header=this.createHeaderConfig();let l=this.layoutManager.createContentItem(a,this);l.addChild(e),e=l}if(r){let a=this.stackParent.contentItems.indexOf(this);this.stackParent.addChild(e,s?a:a+1,!0),this.size*=.5,e.size=this.size,e.sizeUnit=this.sizeUnit,this.stackParent.updateSize(!1)}else{let a=n?p.column:p.row,l=y.createDefault(a),d=this.layoutManager.createContentItem(l,this);this.stackParent.replaceChild(this,d),d.addChild(e,s?0:void 0,!0),d.addChild(this,s?void 0:0,!0),this.size=50,e.size=50,e.sizeUnit=S.Percent,d.updateSize(!1)}}highlightDropZone(e,t){for(let n in this._contentAreaDimensions){let i=n,s=this._contentAreaDimensions[i].hoverArea;if(s.x1<e&&s.x2>e&&s.y1<t&&s.y2>t){i==="header"?(this._dropSegment="header",this.highlightHeaderDropZone(this._header.leftRightSided?t:e)):(this.resetHeaderDropZone(),this.highlightBodyDropZone(i));return}}}getArea(){if(this.element.style.display==="none")return null;let e=super.getElementArea(this._header.element),t=super.getElementArea(this._childElementContainer);if(e===null||t===null)throw new w("SGAHC13086");let n=t.x2-t.x1,i=t.y2-t.y1;return this._contentAreaDimensions={header:{hoverArea:{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2},highlightArea:{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}}},this.contentItems.length===0?(this._contentAreaDimensions.body={hoverArea:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2},highlightArea:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}},super.getElementArea(this.element)):(this._contentAreaDimensions.left={hoverArea:{x1:t.x1,y1:t.y1,x2:t.x1+n*.25,y2:t.y2},highlightArea:{x1:t.x1,y1:t.y1,x2:t.x1+n*.5,y2:t.y2}},this._contentAreaDimensions.top={hoverArea:{x1:t.x1+n*.25,y1:t.y1,x2:t.x1+n*.75,y2:t.y1+i*.5},highlightArea:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y1+i*.5}},this._contentAreaDimensions.right={hoverArea:{x1:t.x1+n*.75,y1:t.y1,x2:t.x2,y2:t.y2},highlightArea:{x1:t.x1+n*.5,y1:t.y1,x2:t.x2,y2:t.y2}},this._contentAreaDimensions.bottom={hoverArea:{x1:t.x1+n*.25,y1:t.y1+i*.5,x2:t.x1+n*.75,y2:t.y2},highlightArea:{x1:t.x1,y1:t.y1+i*.5,x2:t.x2,y2:t.y2}},super.getElementArea(this.element))}positionHeader(e){this._header.side!==e&&(this._header.setSide(e),this._headerSideChanged=!0,this.setupHeaderPosition())}updateNodeSize(){if(this.element.style.display!=="none"){let e=V(this.element);if(this._header.show){let t=this._header.leftRightSided?Ue.width:Ue.height;e[t]-=this.layoutManager.layoutConfig.dimensions.headerHeight}this._childElementContainer.style.width=b(e.width),this._childElementContainer.style.height=b(e.height);for(let t=0;t<this.contentItems.length;t++)this.contentItems[t].element.style.width=b(e.width),this.contentItems[t].element.style.height=b(e.height);this.emit("resize"),this.emitStateChangedEvent()}}highlightHeaderDropZone(e){let t=this._header.lastVisibleTabIndex+1,i=this._header.tabsContainerElement.childNodes,s=new Array(t),r=0,a=0;for(;a<t;){let u=i[r++];u!==this.layoutManager.tabDropPlaceholder&&(s[a++]=u)}let l=this.layoutManager.dropTargetIndicator;if(l===null)throw new w("SHHDZDTI97110");let d;if(t===0){let u=this._header.element.getBoundingClientRect(),c=u.top+document.body.scrollTop,h=u.left+document.body.scrollLeft;d={x1:h,x2:h+100,y1:c+u.height-20,y2:c+u.height},this._dropIndex=0}else{let u=0,c=!1,h,m,f,_;do{_=s[u];let L=_.getBoundingClientRect(),F=L.top+document.body.scrollTop,B=L.left+document.body.scrollLeft;this._header.leftRightSided?(m=F,h=B,f=L.height):(m=B,h=F,f=L.width),e>=m&&e<m+f?c=!0:u++}while(u<t&&!c);if(c===!1&&e<m)return;let I=m+f/2;e<I?(this._dropIndex=u,_.insertAdjacentElement("beforebegin",this.layoutManager.tabDropPlaceholder)):(this._dropIndex=Math.min(u+1,t),_.insertAdjacentElement("afterend",this.layoutManager.tabDropPlaceholder));let E=this.layoutManager.tabDropPlaceholder.getBoundingClientRect(),P=E.top+document.body.scrollTop,M=E.left+document.body.scrollLeft,H=E.width;if(this._header.leftRightSided){let L=P;d={x1:h,x2:h+_.clientHeight,y1:L,y2:L+H}}else{let L=M;d={x1:L,x2:L+H,y1:h,y2:h+_.clientHeight}}}l.highlightArea(d,0)}resetHeaderDropZone(){this.layoutManager.tabDropPlaceholder.remove()}setupHeaderPosition(){N(this._header.element,this._header.show),this.element.classList.remove("lm_left","lm_right","lm_bottom"),this._header.leftRightSided&&this.element.classList.add("lm_"+this._header.side),this.updateSize(!1)}highlightBodyDropZone(e){if(this._contentAreaDimensions===void 0)throw new g("SHBDZC82265");{let t=this._contentAreaDimensions[e].highlightArea,n=this.layoutManager.dropTargetIndicator;if(n===null)throw new w("SHBDZD96110");n.highlightArea(t,1),this._dropSegment=e}}handleResize(){this._header.updateTabSizes()}handleMaximised(){this._header.processMaximised()}handleMinimised(){this._header.processMinimised()}handlePopoutEvent(){this.popout()}handleHeaderClickEvent(e){let t=z.headerClickEventName,n=new z.ClickBubblingEvent(t,this,e);this.emit(t,n)}handleHeaderTouchStartEvent(e){let t=z.headerTouchStartEventName,n=new z.TouchStartBubblingEvent(t,this,e);this.emit(t,n)}handleHeaderComponentRemoveEvent(e){this.removeChild(e,!1)}handleHeaderComponentFocusEvent(e){this.setActiveComponentItem(e,!0)}handleHeaderComponentStartDragEvent(e,t,n,i){this.isMaximised===!0&&this.toggleMaximise(),this.layoutManager.startComponentDrag(e,t,n,i,this)}createHeaderConfig(){if(this._headerSideChanged){let e=this._header.show?this._header.side:!1,t=W.Header.createCopy(this._headerConfig,e);return t===void 0&&(t={show:e,popout:void 0,maximise:void 0,close:void 0,minimise:void 0,tabDropdown:void 0}),t}else return W.Header.createCopy(this._headerConfig)}emitStateChangedEvent(){this.emitBaseBubblingEvent("stateChanged")}};(function(o){function e(t){let n=t.createElement("div");return n.classList.add("lm_item"),n.classList.add("lm_stack"),n}o.createElement=e})(Y||(Y={}));var ve=class extends z{constructor(e,t,n,i,s,r){if(super(),this._dragListener=n,this._layoutManager=i,this._componentItem=s,this._originalParent=r,this._area=null,this._lastValidArea=null,this._dragListener.on("drag",(a,l,d)=>this.onDrag(a,l,d)),this._dragListener.on("dragStop",()=>this.onDrop()),this.createDragProxyElements(e,t),this._componentItem.parent===null)throw new w("DPC10097");this._componentItemFocused=this._componentItem.focused,this._componentItemFocused&&this._componentItem.blur(),this._componentItem.parent.removeChild(this._componentItem,!0),this.setDimensions(),document.body.appendChild(this._element),this.determineMinMaxXY(),this._layoutManager.calculateItemAreas(),this.setDropPosition(e,t)}get element(){return this._element}createDragProxyElements(e,t){this._element=document.createElement("div"),this._element.classList.add("lm_dragProxy");let n=document.createElement("div");n.classList.add("lm_header");let i=document.createElement("div");i.classList.add("lm_tabs");let s=document.createElement("div");s.classList.add("lm_tab");let r=document.createElement("span");r.classList.add("lm_title"),s.appendChild(r),i.appendChild(s),n.appendChild(i),this._proxyContainerElement=document.createElement("div"),this._proxyContainerElement.classList.add("lm_content"),this._element.appendChild(n),this._element.appendChild(this._proxyContainerElement),this._originalParent instanceof Y&&this._originalParent.headerShow&&(this._sided=this._originalParent.headerLeftRightSided,this._element.classList.add("lm_"+this._originalParent.headerSide),[X.right,X.bottom].indexOf(this._originalParent.headerSide)>=0&&this._proxyContainerElement.insertAdjacentElement("afterend",n)),this._element.style.left=b(e),this._element.style.top=b(t),s.setAttribute("title",this._componentItem.title),r.insertAdjacentText("afterbegin",this._componentItem.title),this._proxyContainerElement.appendChild(this._componentItem.element)}determineMinMaxXY(){let e=this._layoutManager.groundItem;if(e===void 0)throw new g("DPDMMXY73109");{let n=e.element.getBoundingClientRect();this._minX=n.left+document.body.scrollLeft,this._minY=n.top+document.body.scrollTop,this._maxX=this._minX+n.width,this._maxY=this._minY+n.height}}onDrag(e,t,n){let i=n.pageX,s=n.pageY;this.setDropPosition(i,s),this._componentItem.drag()}setDropPosition(e,t){this._layoutManager.layoutConfig.settings.constrainDragToContainer&&(e<=this._minX?e=Math.ceil(this._minX):e>=this._maxX&&(e=Math.floor(this._maxX)),t<=this._minY?t=Math.ceil(this._minY):t>=this._maxY&&(t=Math.floor(this._maxY))),this._element.style.left=b(e),this._element.style.top=b(t),this._area=this._layoutManager.getArea(e,t),this._area!==null&&(this._lastValidArea=this._area,this._area.contentItem.highlightDropZone(e,t,this._area))}onDrop(){let e=this._layoutManager.dropTargetIndicator;if(e===null)throw new w("DPOD30011");e.hide(),this._componentItem.exitDragMode();let t;this._area!==null?(t=this._componentItem,this._area.contentItem.onDrop(t,this._area)):this._lastValidArea!==null?(t=this._componentItem,this._lastValidArea.contentItem.onDrop(t,this._lastValidArea)):this._originalParent?(t=this._componentItem,this._originalParent.addChild(t)):this._componentItem.destroy(),this._element.remove(),this._layoutManager.emit("itemDropped",this._componentItem),this._componentItemFocused&&t!==void 0&&t.focus()}setDimensions(){let e=this._layoutManager.layoutConfig.dimensions;if(e===void 0)throw new Error("DragProxy.setDimensions: dimensions undefined");let t=e.dragProxyWidth,n=e.dragProxyHeight;if(t===void 0||n===void 0)throw new Error("DragProxy.setDimensions: width and/or height undefined");let i=this._layoutManager.layoutConfig.header.show===!1?0:e.headerHeight;this._element.style.width=b(t),this._element.style.height=b(n),t-=this._sided?i:0,n-=this._sided?0:i,this._proxyContainerElement.style.width=b(t),this._proxyContainerElement.style.height=b(n),this._componentItem.enterDragMode(t,n),this._componentItem.show()}};var Ie=class o{constructor(e,t,n,i,s,r,a){this._layoutManager=e,this._element=t,this._extraAllowableChildTargets=n,this._componentTypeOrFtn=i,this._componentState=s,this._title=r,this._id=a,this._dragListener=null,this._dummyGroundContainer=document.createElement("div");let l=re.createDefault("row");this._dummyGroundContentItem=new ie(this._layoutManager,l,this._dummyGroundContainer),this.createDragListener()}destroy(){this.removeDragListener()}createDragListener(){this.removeDragListener(),this._dragListener=new ae(this._element,this._extraAllowableChildTargets),this._dragListener.on("dragStart",(e,t)=>this.onDragStart(e,t)),this._dragListener.on("dragStop",()=>this.onDragStop())}onDragStart(e,t){var n;let i="component",s;if(typeof this._componentTypeOrFtn=="function"){let l=this._componentTypeOrFtn();o.isDragSourceComponentItemConfig(l)?s={type:i,componentState:l.state,componentType:l.type,title:(n=l.title)!==null&&n!==void 0?n:this._title}:s=l}else s={type:i,componentState:this._componentState,componentType:this._componentTypeOrFtn,title:this._title,id:this._id};let r=Q.resolve(s,!1),a=new G(this._layoutManager,r,this._dummyGroundContentItem);if(this._dummyGroundContentItem.contentItems.push(a),this._dragListener===null)throw new w("DSODSD66746");{let l=new ve(e,t,this._dragListener,this._layoutManager,a,this._dummyGroundContentItem),d=this._layoutManager.transitionIndicator;if(d===null)throw new w("DSODST66746");d.transitionElements(this._element,l.element)}}onDragStop(){this.createDragListener()}removeDragListener(){this._dragListener!==null&&(this._dragListener.destroy(),this._dragListener=null)}};(function(o){function e(t){return!("componentType"in t)}o.isDragSourceComponentItemConfig=e})(Ie||(Ie={}));var je=class{constructor(){this._element=document.createElement("div"),this._element.classList.add("lm_dropTargetIndicator");let e=document.createElement("div");e.classList.add("lm_inner"),this._element.appendChild(e),document.body.appendChild(this._element)}destroy(){this._element.remove()}highlightArea(e,t){this._element.style.left=b(e.x1+t),this._element.style.top=b(e.y1+t),this._element.style.width=b(e.x2-e.x1-t),this._element.style.height=b(e.y2-e.y1-t),this._element.style.display="block"}hide(){N(this._element,!1)}};var Xe=class{constructor(){this._element=document.createElement("div"),this._element.classList.add("lm_transition_indicator"),document.body.appendChild(this._element),this._toElement=null,this._fromDimensions=null,this._totalAnimationDuration=200,this._animationStartTime=null}destroy(){this._element.remove()}transitionElements(e,t){}nextAnimationFrame(){}measure(e){let t=e.getBoundingClientRect();return{left:t.left,top:t.top,width:e.offsetWidth,height:e.offsetHeight}}};var ye=class o extends z{constructor(e){super(),this._layoutManager=e,this._childEventListener=t=>this.onEventFromChild(t),globalThis.addEventListener(o.ChildEventName,this._childEventListener,{passive:!0})}emit(e,...t){e==="userBroadcast"?this.emitUserBroadcast(...t):super.emit(e,...t)}emitUserBroadcast(...e){this.handleUserBroadcastEvent("userBroadcast",e)}destroy(){globalThis.removeEventListener(o.ChildEventName,this._childEventListener)}handleUserBroadcastEvent(e,t){this._layoutManager.isSubWindow?this.propagateToParent(e,t):this.propagateToThisAndSubtree(e,t)}onEventFromChild(e){let t=e.detail;this.handleUserBroadcastEvent(t.eventName,t.args)}propagateToParent(e,t){let i={bubbles:!0,cancelable:!0,detail:{layoutManager:this._layoutManager,eventName:e,args:t}},s=new CustomEvent(o.ChildEventName,i),r=globalThis.opener;if(r===null)throw new w("EHPTP15778");r.dispatchEvent(s)}propagateToThisAndSubtree(e,t){this.emitUnknown(e,...t);for(let n=0;n<this._layoutManager.openPopouts.length;n++){let i=this._layoutManager.openPopouts[n].getGlInstance();i&&i.eventHub.propagateToThisAndSubtree(e,t)}}};(function(o){o.ChildEventName="gl_child_event"})(ye||(ye={}));var be=class o extends z{constructor(e){super(),this.resizeWithContainerAutomatically=!1,this.resizeDebounceInterval=100,this.resizeDebounceExtendedWhenPossible=!0,this._isInitialised=!1,this._groundItem=void 0,this._openPopouts=[],this._dropTargetIndicator=null,this._transitionIndicator=null,this._itemAreas=[],this._maximisePlaceholder=o.createMaximisePlaceElement(document),this._tabDropPlaceholder=o.createTabDropPlaceholderElement(document),this._dragSources=[],this._updatingColumnsResponsive=!1,this._firstLoad=!0,this._eventHub=new ye(this),this._width=null,this._height=null,this._virtualSizedContainers=[],this._virtualSizedContainerAddingBeginCount=0,this._sizeInvalidationBeginCount=0,this._resizeObserver=new ResizeObserver(()=>this.handleContainerResize()),this._windowBeforeUnloadListener=()=>this.onBeforeUnload(),this._windowBeforeUnloadListening=!1,this._maximisedStackBeforeDestroyedListener=t=>this.cleanupBeforeMaximisedStackDestroyed(t),this.isSubWindow=e.isSubWindow,this._constructorOrSubWindowLayoutConfig=e.constructorOrSubWindowLayoutConfig,Ee.checkInitialise(),de.checkInitialise(),e.containerElement!==void 0&&(this._containerElement=e.containerElement)}get container(){return this._containerElement}get isInitialised(){return this._isInitialised}get groundItem(){return this._groundItem}get root(){return this._groundItem}get openPopouts(){return this._openPopouts}get dropTargetIndicator(){return this._dropTargetIndicator}get transitionIndicator(){return this._transitionIndicator}get width(){return this._width}get height(){return this._height}get eventHub(){return this._eventHub}get rootItem(){if(this._groundItem===void 0)throw new Error("Cannot access rootItem before init");return this._groundItem.contentItems.length===0?void 0:this._groundItem.contentItems[0]}get focusedComponentItem(){return this._focusedComponentItem}get tabDropPlaceholder(){return this._tabDropPlaceholder}get maximisedStack(){return this._maximisedStack}get deprecatedConstructor(){return!this.isSubWindow&&this._constructorOrSubWindowLayoutConfig!==void 0}destroy(){if(this._isInitialised){this._windowBeforeUnloadListening&&(globalThis.removeEventListener("beforeunload",this._windowBeforeUnloadListener),this._windowBeforeUnloadListening=!1),this.layoutConfig.settings.closePopoutsOnUnload===!0&&this.closeAllOpenPopouts(),this._resizeObserver.disconnect(),this.checkClearResizeTimeout(),this._groundItem!==void 0&&this._groundItem.destroy(),this._tabDropPlaceholder.remove(),this._dropTargetIndicator!==null&&this._dropTargetIndicator.destroy(),this._transitionIndicator!==null&&this._transitionIndicator.destroy(),this._eventHub.destroy();for(let e of this._dragSources)e.destroy();this._dragSources=[],this._isInitialised=!1}}minifyConfig(e){return C.minifyConfig(e)}unminifyConfig(e){return C.unminifyConfig(e)}init(){this.setContainer(),this._dropTargetIndicator=new je,this._transitionIndicator=new Xe,this.updateSizeFromContainer();let e;if(this.isSubWindow){if(this._constructorOrSubWindowLayoutConfig===void 0)throw new g("LMIU07155");{let n=this._constructorOrSubWindowLayoutConfig.root;if(n===void 0)throw new v("LMIC07156");if(x.isComponent(n))e=n;else throw new v("LMIC07157");let i=O.resolve(this._constructorOrSubWindowLayoutConfig);this.layoutConfig=Object.assign(Object.assign({},i),{root:void 0})}}else this._constructorOrSubWindowLayoutConfig===void 0?this.layoutConfig=C.createDefault():this.layoutConfig=O.resolve(this._constructorOrSubWindowLayoutConfig);let t=this.layoutConfig;this._groundItem=new ie(this,t.root,this._containerElement),this._groundItem.init(),this.checkLoadedLayoutMaximiseItem(),this._resizeObserver.observe(this._containerElement),this._isInitialised=!0,this.adjustColumnsResponsive(),this.emit("initialised"),e!==void 0&&this.loadComponentAsRoot(e)}loadLayout(e){if(this.isInitialised){if(this._groundItem===void 0)throw new g("LMLL11119");this.createSubWindows(),this.layoutConfig=O.resolve(e),this._groundItem.loadRoot(this.layoutConfig.root),this.checkLoadedLayoutMaximiseItem(),this.adjustColumnsResponsive()}else throw new Error("GoldenLayout: Need to call init() if LayoutConfig with defined root passed to constructor")}saveLayout(){if(this._isInitialised===!1)throw new Error("Can't create config, layout not yet initialised");if(this._groundItem===void 0)throw new g("LMTC18244");{let e=this._groundItem.calculateConfigContent(),t;e.length!==1?t=void 0:t=e[0],this.reconcilePopoutWindows();let n=[];for(let s=0;s<this._openPopouts.length;s++)n.push(this._openPopouts[s].toConfig());return{root:t,openPopouts:n,settings:C.Settings.createCopy(this.layoutConfig.settings),dimensions:C.Dimensions.createCopy(this.layoutConfig.dimensions),header:C.Header.createCopy(this.layoutConfig.header),resolved:!0}}}clear(){if(this._groundItem===void 0)throw new g("LMCL11129");this._groundItem.clearRoot()}toConfig(){return this.saveLayout()}newComponent(e,t,n){let i=this.newComponentAtLocation(e,t,n);if(i===void 0)throw new v("LMNC65588");return i}newComponentAtLocation(e,t,n,i){if(this._groundItem===void 0)throw new Error("Cannot add component before init");{let s=this.addComponentAtLocation(e,t,n,i);if(s===void 0)return;{let r=s.parentItem.contentItems[s.index];if(A.isComponentItem(r))return r;throw new v("LMNC992877533")}}}addComponent(e,t,n){let i=this.addComponentAtLocation(e,t,n);if(i===void 0)throw new v("LMAC99943");return i}addComponentAtLocation(e,t,n,i){let s={type:"component",componentType:e,componentState:t,title:n};return this.addItemAtLocation(s,i)}newItem(e){let t=this.newItemAtLocation(e);if(t===void 0)throw new v("LMNC65588");return t}newItemAtLocation(e,t){if(this._groundItem===void 0)throw new Error("Cannot add component before init");{let n=this.addItemAtLocation(e,t);return n===void 0?void 0:n.parentItem.contentItems[n.index]}}addItem(e){let t=this.addItemAtLocation(e);if(t===void 0)throw new v("LMAI99943");return t}addItemAtLocation(e,t){if(this._groundItem===void 0)throw new Error("Cannot add component before init");{t===void 0&&(t=o.defaultLocationSelectors);let n=this.findFirstLocation(t);if(n===void 0)return;{let i=n.parentItem,s;switch(i.type){case p.ground:{s=i.addItem(e,n.index),s>=0?i=this._groundItem.contentItems[0]:s=0;break}case p.row:case p.column:{s=i.addItem(e,n.index);break}case p.stack:if(x.isComponent(e)){s=i.addItem(e,n.index);break}else throw Error(U[6]);case p.component:throw new v("LMAIALC87444602");default:throw new D("LMAIALU98881733",i.type)}if(x.isComponent(e)){let r=i.contentItems[s];A.isStack(r)&&(i=r,s=0)}return n.parentItem=i,n.index=s,n}}}loadComponentAsRoot(e){if(this._groundItem===void 0)throw new Error("Cannot add item before init");this._groundItem.loadComponentAsRoot(e)}updateSize(e,t){this.setSize(e,t)}setSize(e,t){if(this._width=e,this._height=t,this._isInitialised===!0){if(this._groundItem===void 0)throw new g("LMUS18881");if(this._groundItem.setSize(this._width,this._height),this._maximisedStack){let{width:n,height:i}=V(this._containerElement);R(this._maximisedStack.element,n),k(this._maximisedStack.element,i),this._maximisedStack.updateSize(!1)}this.adjustColumnsResponsive()}}beginSizeInvalidation(){this._sizeInvalidationBeginCount++}endSizeInvalidation(){--this._sizeInvalidationBeginCount===0&&this.updateSizeFromContainer()}updateSizeFromContainer(){let{width:e,height:t}=V(this._containerElement);this.setSize(e,t)}updateRootSize(e=!1){if(this._groundItem===void 0)throw new g("LMURS28881");this._groundItem.updateSize(e)}createAndInitContentItem(e,t){let n=this.createContentItem(e,t);return n.init(),n}createContentItem(e,t){if(typeof e.type!="string")throw new j("Missing parameter 'type'",JSON.stringify(e));return y.isComponentItem(e)&&!(t instanceof Y)&&t&&!(this.isSubWindow===!0&&t instanceof ie)&&(e={type:p.stack,content:[e],size:e.size,sizeUnit:e.sizeUnit,minSize:e.minSize,minSizeUnit:e.minSizeUnit,id:e.id,maximised:e.maximised,isClosable:e.isClosable,activeItemIndex:0,header:void 0}),this.createContentItemFromConfig(e,t)}findFirstComponentItemById(e){if(this._groundItem===void 0)throw new g("LMFFCIBI82446");return this.findFirstContentItemTypeByIdRecursive(p.component,e,this._groundItem)}createPopout(e,t,n,i){return e instanceof A?this.createPopoutFromContentItem(e,t,n,i):this.createPopoutFromItemConfig(e,t,n,i)}createPopoutFromContentItem(e,t,n,i){let s=e.parent,r=e;for(;s!==null&&s.contentItems.length===1&&!s.isGround;)r=s,s=s.parent;if(s===null)throw new w("LMCPFCI00834");{if(i===void 0&&(i=s.contentItems.indexOf(r)),n!==null&&s.addPopInParentId(n),t===void 0){let l=globalThis.screenX||globalThis.screenLeft,d=globalThis.screenY||globalThis.screenTop,u=e.element.offsetLeft,c=e.element.offsetTop,{width:h,height:m}=V(e.element);t={left:l+u,top:d+c,width:h,height:m}}let a=e.toConfig();if(e.remove(),K.isRootItemConfig(a))return this.createPopoutFromItemConfig(a,t,n,i);throw new Error(`${U[0]}`)}}beginVirtualSizedContainerAdding(){++this._virtualSizedContainerAddingBeginCount===0&&(this._virtualSizedContainers.length=0)}addVirtualSizedContainer(e){this._virtualSizedContainers.push(e)}endVirtualSizedContainerAdding(){if(--this._virtualSizedContainerAddingBeginCount===0){let e=this._virtualSizedContainers.length;if(e>0){this.fireBeforeVirtualRectingEvent(e);for(let t=0;t<e;t++)this._virtualSizedContainers[t].notifyVirtualRectingRequired();this.fireAfterVirtualRectingEvent(),this._virtualSizedContainers.length=0}}}fireBeforeVirtualRectingEvent(e){this.beforeVirtualRectingEvent!==void 0&&this.beforeVirtualRectingEvent(e)}fireAfterVirtualRectingEvent(){this.afterVirtualRectingEvent!==void 0&&this.afterVirtualRectingEvent()}createPopoutFromItemConfig(e,t,n,i){let s=this.toConfig(),r={root:e,openPopouts:[],settings:s.settings,dimensions:s.dimensions,header:s.header,window:t,parentId:n,indexInParent:i,resolved:!0};return this.createPopoutFromPopoutLayoutConfig(r)}createPopoutFromPopoutLayoutConfig(e){var t,n,i,s;let r=e.window,a={left:(t=r.left)!==null&&t!==void 0?t:globalThis.screenX||globalThis.screenLeft+20,top:(n=r.top)!==null&&n!==void 0?n:globalThis.screenY||globalThis.screenTop+20,width:(i=r.width)!==null&&i!==void 0?i:500,height:(s=r.height)!==null&&s!==void 0?s:309},l=new Ve(e,a,this);return l.on("initialised",()=>this.emit("windowOpened",l)),l.on("closed",()=>this.reconcilePopoutWindows()),this._openPopouts.push(l),this.layoutConfig.settings.closePopoutsOnUnload&&!this._windowBeforeUnloadListening&&(globalThis.addEventListener("beforeunload",this._windowBeforeUnloadListener,{passive:!0}),this._windowBeforeUnloadListening=!0),l}closeAllOpenPopouts(){for(let e=0;e<this._openPopouts.length;e++)this._openPopouts[e].close();this._openPopouts.length=0,this._windowBeforeUnloadListening&&(globalThis.removeEventListener("beforeunload",this._windowBeforeUnloadListener),this._windowBeforeUnloadListening=!1)}newDragSource(e,t,n,i,s){let r=new Ie(this,e,[],t,n,i,s);return this._dragSources.push(r),r}removeDragSource(e){vt(e,this._dragSources),e.destroy()}startComponentDrag(e,t,n,i,s){new ve(e,t,n,this,i,s)}focusComponent(e,t=!1){e.focus(t)}clearComponentFocus(e=!1){this.setFocusedComponentItem(void 0,e)}setFocusedComponentItem(e,t=!1){if(e!==this._focusedComponentItem){let n;if(e===void 0||(n=e.parentItem),this._focusedComponentItem!==void 0){let i=this._focusedComponentItem;this._focusedComponentItem=void 0,i.setBlurred(t);let s=i.parentItem;n===s?n=void 0:s.setFocusedValue(!1)}e!==void 0&&(this._focusedComponentItem=e,e.setFocused(t),n!==void 0&&n.setFocusedValue(!0))}}createContentItemFromConfig(e,t){switch(e.type){case p.ground:throw new v("LMCCIFC68871");case p.row:return new ne(!1,this,e,t);case p.column:return new ne(!0,this,e,t);case p.stack:return new Y(this,e,t);case p.component:return new G(this,e,t);default:throw new D("CCC913564",e.type,"Invalid Config Item type specified")}}setMaximisedStack(e){e===void 0?this._maximisedStack!==void 0&&this.processMinimiseMaximisedStack():e!==this._maximisedStack&&(this._maximisedStack!==void 0&&this.processMinimiseMaximisedStack(),this.processMaximiseStack(e))}checkMinimiseMaximisedStack(){this._maximisedStack!==void 0&&this._maximisedStack.minimise()}cleanupBeforeMaximisedStackDestroyed(e){this._maximisedStack!==null&&this._maximisedStack===e.target&&(this._maximisedStack.off("beforeItemDestroyed",this._maximisedStackBeforeDestroyedListener),this._maximisedStack=void 0)}closeWindow(){globalThis.setTimeout(()=>globalThis.close(),1)}getArea(e,t){let n=null,i=1/0;for(let s=0;s<this._itemAreas.length;s++){let r=this._itemAreas[s];e>=r.x1&&e<r.x2&&t>=r.y1&&t<r.y2&&i>r.surface&&(i=r.surface,n=r)}return n}calculateItemAreas(){let e=this.getAllContentItems(),t=this._groundItem;if(t===void 0)throw new g("LMCIAR44365");if(e.length===1){let n=t.getElementArea();if(n===null)throw new w("LMCIARA44365");this._itemAreas=[n];return}else{t.contentItems[0].isStack?this._itemAreas=[]:this._itemAreas=t.createSideAreas();for(let n=0;n<e.length;n++){let i=e[n];if(A.isStack(i)){let s=i.getArea();if(s===null)continue;{this._itemAreas.push(s);let r=i.contentAreaDimensions;if(r===void 0)throw new g("LMCIASC45599");{let a=r.header.highlightArea,l=(a.x2-a.x1)*(a.y2-a.y1),d={x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2,contentItem:i,surface:l};this._itemAreas.push(d)}}}}}}checkLoadedLayoutMaximiseItem(){if(this._groundItem===void 0)throw new g("LMCLLMI43432");{let e=this._groundItem.getConfigMaximisedItems();if(e.length>0){let t=e[0];if(A.isComponentItem(t)){let n=t.parent;if(n===null)throw new w("LMXLLMI69999");t=n}if(A.isStack(t))t.maximise();else throw new v("LMCLLMI19993")}}}processMaximiseStack(e){if(this._maximisedStack=e,e.on("beforeItemDestroyed",this._maximisedStackBeforeDestroyedListener),e.element.classList.add("lm_maximised"),e.element.insertAdjacentElement("afterend",this._maximisePlaceholder),this._groundItem===void 0)throw new g("LMMXI19993");{this._groundItem.element.prepend(e.element);let{width:t,height:n}=V(this._containerElement);R(e.element,t),k(e.element,n),e.updateSize(!0),e.focusActiveContentItem(),this._maximisedStack.emit("maximised"),this.emit("stateChanged")}}processMinimiseMaximisedStack(){if(this._maximisedStack===void 0)throw new v("LMMMS74422");{let e=this._maximisedStack;if(e.parent===null)throw new w("LMMI13668");e.element.classList.remove("lm_maximised"),this._maximisePlaceholder.insertAdjacentElement("afterend",e.element),this._maximisePlaceholder.remove(),this.updateRootSize(!0),this._maximisedStack=void 0,e.off("beforeItemDestroyed",this._maximisedStackBeforeDestroyedListener),e.emit("minimised"),this.emit("stateChanged")}}reconcilePopoutWindows(){let e=[];for(let t=0;t<this._openPopouts.length;t++)this._openPopouts[t].getWindow().closed===!1?e.push(this._openPopouts[t]):this.emit("windowClosed",this._openPopouts[t]);this._openPopouts.length!==e.length&&(this._openPopouts=e,this.emit("stateChanged"))}getAllContentItems(){if(this._groundItem===void 0)throw new g("LMGACI13130");return this._groundItem.getAllContentItems()}createSubWindows(){for(let e=0;e<this.layoutConfig.openPopouts.length;e++){let t=this.layoutConfig.openPopouts[e];this.createPopoutFromPopoutLayoutConfig(t)}}handleContainerResize(){this.resizeWithContainerAutomatically&&this.processResizeWithDebounce()}processResizeWithDebounce(){this.resizeDebounceExtendedWhenPossible&&this.checkClearResizeTimeout(),this._resizeTimeoutId===void 0&&(this._resizeTimeoutId=setTimeout(()=>{this._resizeTimeoutId=void 0,this.beginSizeInvalidation(),this.endSizeInvalidation()},this.resizeDebounceInterval))}checkClearResizeTimeout(){this._resizeTimeoutId!==void 0&&(clearTimeout(this._resizeTimeoutId),this._resizeTimeoutId=void 0)}setContainer(){var e;let t=document.body,n=(e=this._containerElement)!==null&&e!==void 0?e:t;if(n===t){this.resizeWithContainerAutomatically=!0;let i=document.documentElement;i.style.height="100%",i.style.margin="0",i.style.padding="0",i.style.overflow="clip",t.style.height="100%",t.style.margin="0",t.style.padding="0",t.style.overflow="clip"}this._containerElement=n}onBeforeUnload(){this.destroy()}adjustColumnsResponsive(){if(this._groundItem===void 0)throw new g("LMACR20883");if(this._firstLoad=!1,this.useResponsiveLayout()&&!this._updatingColumnsResponsive&&this._groundItem.contentItems.length>0&&this._groundItem.contentItems[0].isRow){if(this._groundItem===void 0||this._width===null)throw new g("LMACR77412");{let e=this._groundItem.contentItems[0].contentItems.length;if(e<=1)return;{let t=this.layoutConfig.dimensions.defaultMinItemWidth;if(e*t<=this._width)return;{this._updatingColumnsResponsive=!0;let i=Math.max(Math.floor(this._width/t),1),s=e-i,r=this._groundItem.contentItems[0],a=this.getAllStacks();if(a.length===0)throw new v("LMACRS77413");{let l=a[0];for(let d=0;d<s;d++){let u=r.contentItems[r.contentItems.length-1];this.addChildContentItemsToContainer(l,u)}this._updatingColumnsResponsive=!1}}}}}}useResponsiveLayout(){let e=this.layoutConfig.settings,t=e.responsiveMode===fe.always,n=e.responsiveMode===fe.onload&&this._firstLoad;return t||n}addChildContentItemsToContainer(e,t){let n=t.contentItems;if(t instanceof Y)for(let i=0;i<n.length;i++){let s=n[i];t.removeChild(s,!0),e.addChild(s)}else for(let i=0;i<n.length;i++){let s=n[i];this.addChildContentItemsToContainer(e,s)}}getAllStacks(){if(this._groundItem===void 0)throw new g("LMFASC52778");{let e=[];return this.findAllStacksRecursive(e,this._groundItem),e}}findFirstContentItemType(e){if(this._groundItem===void 0)throw new g("LMFFCIT82446");return this.findFirstContentItemTypeRecursive(e,this._groundItem)}findFirstContentItemTypeRecursive(e,t){let n=t.contentItems,i=n.length;if(i!==0){for(let s=0;s<i;s++){let r=n[s];if(r.type===e)return r}for(let s=0;s<i;s++){let r=n[s],a=this.findFirstContentItemTypeRecursive(e,r);if(a!==void 0)return a}return}}findFirstContentItemTypeByIdRecursive(e,t,n){let i=n.contentItems,s=i.length;if(s!==0){for(let r=0;r<s;r++){let a=i[r];if(a.type===e&&a.id===t)return a}for(let r=0;r<s;r++){let a=i[r],l=this.findFirstContentItemTypeByIdRecursive(e,t,a);if(l!==void 0)return l}return}}findAllStacksRecursive(e,t){let n=t.contentItems;for(let i=0;i<n.length;i++){let s=n[i];s instanceof Y?e.push(s):s.isComponent||this.findAllStacksRecursive(e,s)}}findFirstLocation(e){let t=e.length;for(let n=0;n<t;n++){let i=e[n],s=this.findLocation(i);if(s!==void 0)return s}}findLocation(e){let t=e.index;switch(e.typeId){case 0:{if(this._focusedComponentItem===void 0)return;{let n=this._focusedComponentItem.parentItem,i=n.contentItems,s=i.length;if(t===void 0)return{parentItem:n,index:s};{let a=i.indexOf(this._focusedComponentItem)+t;return a<0||a>s?void 0:{parentItem:n,index:a}}}}case 1:{if(this._focusedComponentItem===void 0)return;{let n=this._focusedComponentItem.parentItem;return this.tryCreateLocationFromParentItem(n,t)}}case 2:{let n=this.findFirstContentItemType(p.stack);return n===void 0?void 0:this.tryCreateLocationFromParentItem(n,t)}case 3:{let n=this.findFirstContentItemType(p.row);return n!==void 0?this.tryCreateLocationFromParentItem(n,t):(n=this.findFirstContentItemType(p.column),n!==void 0?this.tryCreateLocationFromParentItem(n,t):void 0)}case 4:{let n=this.findFirstContentItemType(p.row);return n===void 0?void 0:this.tryCreateLocationFromParentItem(n,t)}case 5:{let n=this.findFirstContentItemType(p.column);return n===void 0?void 0:this.tryCreateLocationFromParentItem(n,t)}case 6:{if(this._groundItem===void 0)throw new g("LMFLRIF18244");return this.rootItem!==void 0?void 0:t===void 0||t===0?{parentItem:this._groundItem,index:0}:void 0}case 7:{if(this._groundItem===void 0)throw new g("LMFLF18244");{let n=this._groundItem.contentItems;if(n.length===0)return t===void 0||t===0?{parentItem:this._groundItem,index:0}:void 0;{let i=n[0];return this.tryCreateLocationFromParentItem(i,t)}}}}}tryCreateLocationFromParentItem(e,t){let i=e.contentItems.length;return t===void 0?{parentItem:e,index:i}:t<0||t>i?void 0:{parentItem:e,index:t}}};(function(o){function e(n){let i=n.createElement("div");return i.classList.add("lm_maximise_place"),i}o.createMaximisePlaceElement=e;function t(n){let i=n.createElement("div");return i.classList.add("lm_drop_tab_placeholder"),i}o.createTabDropPlaceholderElement=t,o.defaultLocationSelectors=[{typeId:1,index:void 0},{typeId:2,index:void 0},{typeId:3,index:void 0},{typeId:7,index:void 0}],o.afterFocusedItemIfPossibleLocationSelectors=[{typeId:0,index:1},{typeId:2,index:void 0},{typeId:3,index:void 0},{typeId:7,index:void 0}]})(be||(be={}));var we=class o extends be{constructor(e,t,n,i){if(super(o.createLayoutManagerConstructorParameters(e,t)),this._bindComponentEventHanlderPassedInConstructor=!1,this._creationTimeoutPassed=!1,t!==void 0&&typeof t=="function"&&(this.bindComponentEvent=t,this._bindComponentEventHanlderPassedInConstructor=!0,n!==void 0&&(this.unbindComponentEvent=n)),!this._bindComponentEventHanlderPassedInConstructor&&this.isSubWindow){if(this._constructorOrSubWindowLayoutConfig===void 0)throw new g("VLC98823");{let s=O.resolve(this._constructorOrSubWindowLayoutConfig);this.layoutConfig=Object.assign(Object.assign({},s),{root:void 0})}}i!==!0&&(this.deprecatedConstructor||this.init())}destroy(){this.bindComponentEvent=void 0,this.unbindComponentEvent=void 0,super.destroy()}init(){if(!this._bindComponentEventHanlderPassedInConstructor&&(document.readyState==="loading"||document.body===null)){document.addEventListener("DOMContentLoaded",()=>this.init(),{passive:!0});return}if(!this._bindComponentEventHanlderPassedInConstructor&&this.isSubWindow===!0&&!this._creationTimeoutPassed){setTimeout(()=>this.init(),7),this._creationTimeoutPassed=!0;return}this.isSubWindow===!0&&(this._bindComponentEventHanlderPassedInConstructor||this.clearHtmlAndAdjustStylesForSubWindow(),window.__glInstance=this),super.init()}clearHtmlAndAdjustStylesForSubWindow(){let e=document.head,t=new Array(4);t[0]=document.querySelectorAll("body link"),t[1]=document.querySelectorAll("body style"),t[2]=document.querySelectorAll("template"),t[3]=document.querySelectorAll(".gl_keep");for(let s=0;s<t.length;s++){let r=t[s];for(let a=0;a<r.length;a++){let l=r[a];e.appendChild(l)}}let n=document.body;n.innerHTML="",n.style.visibility="visible",this.checkAddDefaultPopinButton();let i=document.body.offsetHeight}checkAddDefaultPopinButton(){if(this.layoutConfig.settings.popInOnClose)return!1;{let e=document.createElement("div");e.classList.add("lm_popin"),e.setAttribute("title",this.layoutConfig.header.dock);let t=document.createElement("div");t.classList.add("lm_icon");let n=document.createElement("div");return n.classList.add("lm_bg"),e.appendChild(t),e.appendChild(n),e.addEventListener("click",()=>this.emit("popIn")),document.body.appendChild(e),!0}}bindComponent(e,t){if(this.bindComponentEvent!==void 0)return this.bindComponentEvent(e,t);if(this.getComponentEvent!==void 0)return{virtual:!1,component:this.getComponentEvent(e,t)};{let i=`${U[2]}: ${JSON.stringify(t)}`;throw new Z(i)}}unbindComponent(e,t,n){if(this.unbindComponentEvent!==void 0)this.unbindComponentEvent(e);else if(!t&&this.releaseComponentEvent!==void 0){if(n===void 0)throw new g("VCUCRCU333998");this.releaseComponentEvent(e,n)}}};(function(o){let e=!1;function t(n,i){let s=e?null:new URL(document.location.href).searchParams.get("gl-window");e=!0;let r=s!==null,a,l;if(s!==null){let d=localStorage.getItem(s);if(d===null)throw new Error("Null gl-window Config");localStorage.removeItem(s);let u=JSON.parse(d),c=C.unminifyConfig(u);l=O.fromResolved(c),n instanceof HTMLElement&&(a=n)}else n===void 0?l=void 0:n instanceof HTMLElement?(l=void 0,a=n):l=n,a===void 0&&i instanceof HTMLElement&&(a=i);return{constructorOrSubWindowLayoutConfig:l,isSubWindow:r,containerElement:a}}o.createLayoutManagerConstructorParameters=t})(we||(we={}));var Le=class extends we{constructor(e,t,n){super(e,t,n,!0),this._componentTypesMap=new Map,this._registeredComponentMap=new Map,this._virtuableComponentMap=new Map,this._containerVirtualRectingRequiredEventListener=(i,s,r)=>this.handleContainerVirtualRectingRequiredEvent(i,s,r),this._containerVirtualVisibilityChangeRequiredEventListener=(i,s)=>this.handleContainerVirtualVisibilityChangeRequiredEvent(i,s),this._containerVirtualZIndexChangeRequiredEventListener=(i,s,r)=>this.handleContainerVirtualZIndexChangeRequiredEvent(i,s,r),this.deprecatedConstructor||this.init()}registerComponent(e,t,n=!1){if(typeof t!="function")throw new ke("registerComponent() componentConstructorOrFactoryFtn parameter is not a function");if(t.hasOwnProperty("prototype")){let i=t;this.registerComponentConstructor(e,i,n)}else{let i=t;this.registerComponentFactoryFunction(e,i,n)}}registerComponentConstructor(e,t,n=!1){if(typeof t!="function")throw new Error(U[1]);if(this._componentTypesMap.get(e)!==void 0)throw new Z(`${U[3]}: ${e}`);this._componentTypesMap.set(e,{constructor:t,factoryFunction:void 0,virtual:n})}registerComponentFactoryFunction(e,t,n=!1){if(typeof t!="function")throw new Z("Please register a constructor function");if(this._componentTypesMap.get(e)!==void 0)throw new Z(`${U[3]}: ${e}`);this._componentTypesMap.set(e,{constructor:void 0,factoryFunction:t,virtual:n})}registerComponentFunction(e){this.registerGetComponentConstructorCallback(e)}registerGetComponentConstructorCallback(e){if(typeof e!="function")throw new Error("Please register a callback function");this._getComponentConstructorFtn!==void 0&&console.warn("Multiple component functions are being registered.  Only the final registered function will be used."),this._getComponentConstructorFtn=e}getRegisteredComponentTypeNames(){let e=this._componentTypesMap.keys();return Array.from(e)}getComponentInstantiator(e){let t,n=$.resolveComponentTypeName(e);return n!==void 0&&(t=this._componentTypesMap.get(n)),t===void 0&&this._getComponentConstructorFtn!==void 0&&(t={constructor:this._getComponentConstructorFtn(e),factoryFunction:void 0,virtual:!1}),t}bindComponent(e,t){let n,i=$.resolveComponentTypeName(t);i!==void 0&&(n=this._componentTypesMap.get(i)),n===void 0&&this._getComponentConstructorFtn!==void 0&&(n={constructor:this._getComponentConstructorFtn(t),factoryFunction:void 0,virtual:!1});let s;if(n!==void 0){let r=n.virtual,a;t.componentState===void 0?a=void 0:a=te({},t.componentState);let l,d=n.constructor;if(d!==void 0)l=new d(e,a,r);else{let u=n.factoryFunction;if(u!==void 0)l=u(e,a,r);else throw new v("LMBCFFU10008")}if(r){if(l===void 0)throw new g("GLBCVCU988774");{let u=l,c=u.rootHtmlElement;if(c===void 0)throw new Z(`${U[5]}: ${i}`);Ct(c),this.container.appendChild(c),this._virtuableComponentMap.set(e,u),e.virtualRectingRequiredEvent=this._containerVirtualRectingRequiredEventListener,e.virtualVisibilityChangeRequiredEvent=this._containerVirtualVisibilityChangeRequiredEventListener,e.virtualZIndexChangeRequiredEvent=this._containerVirtualZIndexChangeRequiredEventListener}}this._registeredComponentMap.set(e,l),s={virtual:n.virtual,component:l}}else s=super.bindComponent(e,t);return s}unbindComponent(e,t,n){if(this._registeredComponentMap.get(e)===void 0)super.unbindComponent(e,t,n);else{let s=this._virtuableComponentMap.get(e);if(s!==void 0){let r=s.rootHtmlElement;if(r===void 0)throw new v("GLUC77743",e.title);this.container.removeChild(r),this._virtuableComponentMap.delete(e)}}}fireBeforeVirtualRectingEvent(e){this._goldenLayoutBoundingClientRect=this.container.getBoundingClientRect(),super.fireBeforeVirtualRectingEvent(e)}handleContainerVirtualRectingRequiredEvent(e,t,n){let i=this._virtuableComponentMap.get(e);if(i===void 0)throw new g("GLHCSCE55933");{let s=i.rootHtmlElement;if(s===void 0)throw new Z(U[4]+" "+e.title);{let r=e.element.getBoundingClientRect(),a=r.left-this._goldenLayoutBoundingClientRect.left;s.style.left=b(a);let l=r.top-this._goldenLayoutBoundingClientRect.top;s.style.top=b(l),R(s,t),k(s,n)}}}handleContainerVirtualVisibilityChangeRequiredEvent(e,t){let n=this._virtuableComponentMap.get(e);if(n===void 0)throw new g("GLHCVVCRE55934");{let i=n.rootHtmlElement;if(i===void 0)throw new Z(U[4]+" "+e.title);N(i,t)}}handleContainerVirtualZIndexChangeRequiredEvent(e,t,n){let i=this._virtuableComponentMap.get(e);if(i===void 0)throw new g("GLHCVZICRE55935");{let s=i.rootHtmlElement;if(s===void 0)throw new Z(U[4]+" "+e.title);s.style.zIndex=n}}};var Ke=function(o){return o.GetDashboards="dashboards",o}(Ke||{});var bt=(()=>{let e=class e{constructor(){this.http=ue(ht)}getDashboardData(n){return this.http.mainGet([Ke.GetDashboards],{params:{title:n}}).pipe(De(i=>i.body&&i.body[0]?new ct(i.body[0]):null))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=it({token:e,factory:e.\u0275fac,providedIn:"root"});let o=e;return o})();var wt=(()=>{let e=class e{constructor(){this.dashboardService=ue(bt),this.route=ue(lt),this.viewContainer=ue(ot),this.layout=null,this.dashboard=null}ngOnInit(){this.route.params.subscribe(n=>{this.layout&&this.layout.destroy(),this.getData(n.name)})}ngOnDestroy(){this.layout&&this.layout.destroy()}getData(n){return Qe(this,null,function*(){yield et(this.dashboardService.getDashboardData(n).pipe(De(i=>{this.dashboard=i,this.goldenInit()})))})}goldenInit(){let n={content:[{type:"stack",content:this.dashboard?.comps.map(i=>({type:"component",componentName:i.title}))}]};this.layout=new Le(n,document.getElementById("layoutContainer")),this.dashboard?.comps.forEach(i=>{this.layout?.registerComponent(i.title,(s,r)=>{let a=this.viewContainer.createComponent(i.viewComponent);a.setInput("data",i.data),s.getElement().append(a.location.nativeElement)})}),this.layout.init()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=tt({type:e,selectors:[["app-dashboard"]],decls:1,vars:0,consts:[["id","layoutContainer",1,"w-100","h-100"]],template:function(i,s){i&1&&rt(0,"div",0)}});let o=e;return o})();var Tt=[{path:":name",component:wt}],Et=Tt;var ro=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=nt({type:e}),e.\u0275inj=st({imports:[at,ut,dt.forChild(Et)]});let o=e;return o})();export{ro as DashboardModule};
